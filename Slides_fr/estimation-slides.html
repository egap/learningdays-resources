<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="Mettre votre nom" />
  <title>Estimer les paramètres avec des estimateurs</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="estimation-slides_files/reveal.js-3.3.0.1/css/reveal.css"/>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="estimation-slides_files/reveal.js-3.3.0.1/css/theme/simple.css" id="theme">


  <!-- some tweaks to reveal css -->
  <style type="text/css">
    .reveal h1 { font-size: 2.0em; }
    .reveal h2 { font-size: 1.5em;  }
    .reveal h3 { font-size: 1.25em;	}
    .reveal h4 { font-size: 1em;	}

    .reveal .slides>section,
    .reveal .slides>section>section {
      padding: 0px 0px;
    }



    .reveal table {
      border-width: 1px;
      border-spacing: 2px;
      border-style: dotted;
      border-color: gray;
      border-collapse: collapse;
      font-size: 0.7em;
    }

    .reveal table th {
      border-width: 1px;
      padding-left: 10px;
      padding-right: 25px;
      font-weight: bold;
      border-style: dotted;
      border-color: gray;
    }

    .reveal table td {
      border-width: 1px;
      padding-left: 10px;
      padding-right: 25px;
      border-style: dotted;
      border-color: gray;
    }


  </style>

    <style type="text/css">code{white-space: pre;}</style>


<!-- Printing and PDF exports -->
<script id="paper-css" type="application/dynamic-css">

/* Default Print Stylesheet Template
   by Rob Glazebrook of CSSnewbie.com
   Last Updated: June 4, 2008

   Feel free (nay, compelled) to edit, append, and
   manipulate this file as you see fit. */


@media print {

	/* SECTION 1: Set default width, margin, float, and
	   background. This prevents elements from extending
	   beyond the edge of the printed page, and prevents
	   unnecessary background images from printing */
	html {
		background: #fff;
		width: auto;
		height: auto;
		overflow: visible;
	}
	body {
		background: #fff;
		font-size: 20pt;
		width: auto;
		height: auto;
		border: 0;
		margin: 0 5%;
		padding: 0;
		overflow: visible;
		float: none !important;
	}

	/* SECTION 2: Remove any elements not needed in print.
	   This would include navigation, ads, sidebars, etc. */
	.nestedarrow,
	.controls,
	.fork-reveal,
	.share-reveal,
	.state-background,
	.reveal .progress,
	.reveal .backgrounds {
		display: none !important;
	}

	/* SECTION 3: Set body font face, size, and color.
	   Consider using a serif font for readability. */
	body, p, td, li, div {
		font-size: 20pt!important;
		font-family: Georgia, "Times New Roman", Times, serif !important;
		color: #000;
	}

	/* SECTION 4: Set heading font face, sizes, and color.
	   Differentiate your headings from your body text.
	   Perhaps use a large sans-serif for distinction. */
	h1,h2,h3,h4,h5,h6 {
		color: #000!important;
		height: auto;
		line-height: normal;
		font-family: Georgia, "Times New Roman", Times, serif !important;
		text-shadow: 0 0 0 #000 !important;
		text-align: left;
		letter-spacing: normal;
	}
	/* Need to reduce the size of the fonts for printing */
	h1 { font-size: 28pt !important;  }
	h2 { font-size: 24pt !important; }
	h3 { font-size: 22pt !important; }
	h4 { font-size: 22pt !important; font-variant: small-caps; }
	h5 { font-size: 21pt !important; }
	h6 { font-size: 20pt !important; font-style: italic; }

	/* SECTION 5: Make hyperlinks more usable.
	   Ensure links are underlined, and consider appending
	   the URL to the end of the link for usability. */
	a:link,
	a:visited {
		color: #000 !important;
		font-weight: bold;
		text-decoration: underline;
	}
	/*
	.reveal a:link:after,
	.reveal a:visited:after {
		content: " (" attr(href) ") ";
		color: #222 !important;
		font-size: 90%;
	}
	*/


	/* SECTION 6: more reveal.js specific additions by @skypanther */
	ul, ol, div, p {
		visibility: visible;
		position: static;
		width: auto;
		height: auto;
		display: block;
		overflow: visible;
		margin: 0;
		text-align: left !important;
	}
	.reveal pre,
	.reveal table {
		margin-left: 0;
		margin-right: 0;
	}
	.reveal pre code {
		padding: 20px;
		border: 1px solid #ddd;
	}
	.reveal blockquote {
		margin: 20px 0;
	}
	.reveal .slides {
		position: static !important;
		width: auto !important;
		height: auto !important;

		left: 0 !important;
		top: 0 !important;
		margin-left: 0 !important;
		margin-top: 0 !important;
		padding: 0 !important;
		zoom: 1 !important;

		overflow: visible !important;
		display: block !important;

		text-align: left !important;
		-webkit-perspective: none;
		   -moz-perspective: none;
		    -ms-perspective: none;
		        perspective: none;

		-webkit-perspective-origin: 50% 50%;
		   -moz-perspective-origin: 50% 50%;
		    -ms-perspective-origin: 50% 50%;
		        perspective-origin: 50% 50%;
	}
	.reveal .slides section {
		visibility: visible !important;
		position: static !important;
		width: auto !important;
		height: auto !important;
		display: block !important;
		overflow: visible !important;

		left: 0 !important;
		top: 0 !important;
		margin-left: 0 !important;
		margin-top: 0 !important;
		padding: 60px 20px !important;
		z-index: auto !important;

		opacity: 1 !important;

		page-break-after: always !important;

		-webkit-transform-style: flat !important;
		   -moz-transform-style: flat !important;
		    -ms-transform-style: flat !important;
		        transform-style: flat !important;

		-webkit-transform: none !important;
		   -moz-transform: none !important;
		    -ms-transform: none !important;
		        transform: none !important;

		-webkit-transition: none !important;
		   -moz-transition: none !important;
		    -ms-transition: none !important;
		        transition: none !important;
	}
	.reveal .slides section.stack {
		padding: 0 !important;
	}
	.reveal section:last-of-type {
		page-break-after: avoid !important;
	}
	.reveal section .fragment {
		opacity: 1 !important;
		visibility: visible !important;

		-webkit-transform: none !important;
		   -moz-transform: none !important;
		    -ms-transform: none !important;
		        transform: none !important;
	}
	.reveal section img {
		display: block;
		margin: 15px 0px;
		background: rgba(255,255,255,1);
		border: 1px solid #666;
		box-shadow: none;
	}

	.reveal section small {
		font-size: 0.8em;
	}

}  
</script>


<script id="pdf-css" type="application/dynamic-css">
    
/**
 * This stylesheet is used to print reveal.js
 * presentations to PDF.
 *
 * https://github.com/hakimel/reveal.js#pdf-export
 */

* {
	-webkit-print-color-adjust: exact;
}

body {
	margin: 0 auto !important;
	border: 0;
	padding: 0;
	float: none !important;
	overflow: visible;
}

html {
	width: 100%;
	height: 100%;
	overflow: visible;
}

/* Remove any elements not needed in print. */
.nestedarrow,
.reveal .controls,
.reveal .progress,
.reveal .playback,
.reveal.overview,
.fork-reveal,
.share-reveal,
.state-background {
	display: none !important;
}

h1, h2, h3, h4, h5, h6 {
	text-shadow: 0 0 0 #000 !important;
}

.reveal pre code {
	overflow: hidden !important;
	font-family: Courier, 'Courier New', monospace !important;
}

ul, ol, div, p {
	visibility: visible;
	position: static;
	width: auto;
	height: auto;
	display: block;
	overflow: visible;
	margin: auto;
}
.reveal {
	width: auto !important;
	height: auto !important;
	overflow: hidden !important;
}
.reveal .slides {
	position: static;
	width: 100%;
	height: auto;

	left: auto;
	top: auto;
	margin: 0 !important;
	padding: 0 !important;

	overflow: visible;
	display: block;

	-webkit-perspective: none;
	   -moz-perspective: none;
	    -ms-perspective: none;
	        perspective: none;

	-webkit-perspective-origin: 50% 50%; /* there isn't a none/auto value but 50-50 is the default */
	   -moz-perspective-origin: 50% 50%;
	    -ms-perspective-origin: 50% 50%;
	        perspective-origin: 50% 50%;
}

.reveal .slides section {
	page-break-after: always !important;

	visibility: visible !important;
	position: relative !important;
	display: block !important;
	position: relative !important;

	margin: 0 !important;
	padding: 0 !important;
	box-sizing: border-box !important;
	min-height: 1px;

	opacity: 1 !important;

	-webkit-transform-style: flat !important;
	   -moz-transform-style: flat !important;
	    -ms-transform-style: flat !important;
	        transform-style: flat !important;

	-webkit-transform: none !important;
	   -moz-transform: none !important;
	    -ms-transform: none !important;
	        transform: none !important;
}

.reveal section.stack {
	margin: 0 !important;
	padding: 0 !important;
	page-break-after: avoid !important;
	height: auto !important;
	min-height: auto !important;
}

.reveal img {
	box-shadow: none;
}

.reveal .roll {
	overflow: visible;
	line-height: 1em;
}

/* Slide backgrounds are placed inside of their slide when exporting to PDF */
.reveal section .slide-background {
	display: block !important;
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	z-index: -1;
}

/* All elements should be above the slide-background */
.reveal section>* {
	position: relative;
	z-index: 1;
}

/* Display slide speaker notes when 'showNotes' is enabled */
.reveal .speaker-notes-pdf {
	display: block;
	width: 100%;
	max-height: none;
	left: auto;
	top: auto;
	z-index: 100;
}

/* Display slide numbers when 'slideNumber' is enabled */
.reveal .slide-number-pdf {
	display: block;
	position: absolute;
	font-size: 14px;
}

</script>


<script>
var style = document.createElement( 'style' );
style.type = 'text/css';
var style_script_id = window.location.search.match( /print-pdf/gi ) ? 'pdf-css' : 'paper-css';
var style_script = document.getElementById(style_script_id).text;
style.innerHTML = style_script;
document.getElementsByTagName('head')[0].appendChild(style);
</script>

    <script src="estimation-slides_files/header-attrs-2.11/header-attrs.js"></script>
    <link href="estimation-slides_files/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
    <link href="estimation-slides_files/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section>
    <h1 class="title">Estimer les paramètres avec des estimateurs</h1>
    <h2 class="author">Mettre votre nom</h2>
    <h3 class="date">23-02-2022</h3>
</section>
<section id="TOC">
<ul>
<li><a href="#/points-clés">Points clés</a>
<ul>
<li><a href="#/points-clés-sur-lestimation-i">Points clés sur l’estimation I</a></li>
<li><a href="#/points-clés-sur-lestimation-ii">Points clés sur l’estimation II</a></li>
<li><a href="#/points-clés-sur-lestimation-iii">Points clés sur l’estimation III</a></li>
<li><a href="#/points-clés-sur-lestimation-iv">Points clés sur l’estimation IV</a></li>
<li><a href="#/points-clés-sur-lestimation-v">Points clés sur l’estimation V</a></li>
</ul></li>
<li><a href="#/revue">Revue</a>
<ul>
<li><a href="#/revue-effet-causal">Revue : effet causal</a></li>
</ul></li>
<li><a href="#/paramètres-estimateurs-et-moyennes">Paramètres, estimateurs et moyennes</a>
<ul>
<li><a href="#/comment-en-savoir-plus-sur-les-effets-causaux-à-partir-des-données-observées">Comment en savoir plus sur les effets causaux à partir des données observées ?</a></li>
<li><a href="#/un-paramètre-et-un-estimateur-usuels-leffet-moyen-du-traitement-et-la-différence-des-moyennes">Un paramètre et un estimateur usuels : l’effet moyen du traitement et la différence des moyennes</a></li>
<li><a href="#/étape-1-de-la-simulation-créer-des-données-avec-un-ate-connu">Étape 1 de la simulation : créer des données avec un ATE connu</a></li>
<li><a href="#/commencez-par-créer-de-fausses-données">Commencez par créer de fausses données</a></li>
<li><a href="#/avec-declaredesign">Avec DeclareDesign</a></li>
<li><a href="#/avec-declaredesign-créer-de-fausses-données">Avec DeclareDesign : créer de fausses données</a></li>
<li><a href="#/avec-declaredesign-définir-le-paramètre-et-les-estimateurs">Avec DeclareDesign : définir le paramètre et les estimateurs</a></li>
<li><a href="#/avec-declaredesign-définir-le-paramètre-et-les-estimateurs-1">Avec DeclareDesign : définir le paramètre et les estimateurs</a></li>
<li><a href="#/avec-declaredesign-définir-le-paramètre-et-les-estimateurs-2">Avec DeclareDesign : définir le paramètre et les estimateurs</a></li>
<li><a href="#/puis-simuler-avec-une-randomisation">Puis simuler avec une randomisation</a></li>
<li><a href="#/puis-simuler-avec-une-randomisation-1">Puis simuler avec une randomisation</a></li>
<li><a href="#/ensuite-simuler-une-randomisation-différente-et-estimer-late-avec-les-mêmes-estimateurs">Ensuite simuler une randomisation différente et estimer l’ATE avec les mêmes estimateurs</a></li>
<li><a href="#/comment-nos-estimateurs-se-comportent-ils-en-général-pour-cette-conception">Comment nos estimateurs se comportent-ils en général pour cette conception ?</a></li>
<li><a href="#/comment-nos-estimateurs-se-comportent-ils-en-général-pour-cette-conception-1">Comment nos estimateurs se comportent-ils en général pour cette conception ?</a></li>
<li><a href="#/quel-estimateur-est-le-plus-proche-de-la-vérité">Quel estimateur est le plus proche de la vérité ?</a></li>
<li><a href="#/estimateurs-biaisés-et-non-biaisés">Estimateurs biaisés et non-biaisés</a></li>
</ul></li>
<li><a href="#/randomisation-par-bloc">Randomisation par bloc</a>
<ul>
<li><a href="#/les-expériences-aléatoires-par-bloc-sont-une-collection-de-mini-expériences">Les expériences aléatoires par bloc sont une collection de mini-expériences</a></li>
<li><a href="#/les-expériences-aléatoires-par-bloc-sont-une-collection-de-mini-expériences-1">Les expériences aléatoires par bloc sont une collection de mini-expériences</a></li>
<li><a href="#/estimer-late-dans-les-expériences-aléatoires-par-bloc">Estimer l’ATE dans les expériences aléatoires par bloc</a></li>
<li><a href="#/estimer-late-dans-les-expériences-aléatoires-par-bloc-1">Estimer l’ATE dans les expériences aléatoires par bloc</a></li>
<li><a href="#/estimer-late-dans-les-expériences-aléatoires-par-bloc-2">Estimer l’ATE dans les expériences aléatoires par bloc</a></li>
<li><a href="#/estimer-late-dans-les-expériences-aléatoires-par-bloc-3">Estimer l’ATE dans les expériences aléatoires par bloc</a></li>
<li><a href="#/quel-estimateur-doit-on-utiliser">Quel estimateur doit-on utiliser ?</a></li>
<li><a href="#/quel-estimateur-doit-on-utiliser-1">Quel estimateur doit-on utiliser ?</a></li>
<li><a href="#/quel-estimateur-doit-on-utiliser-2">Quel estimateur doit-on utiliser ?</a></li>
<li><a href="#/quel-estimateur-doit-on-utiliser-3">Quel estimateur doit-on utiliser ?</a></li>
<li><a href="#/quel-estimateur-est-le-plus-proche-de-la-vérité-1">Quel estimateur est le plus proche de la vérité ?</a></li>
</ul></li>
<li><a href="#/randomisation-par-grappe">Randomisation par grappe</a>
<ul>
<li><a href="#/dans-les-expériences-aléatoires-par-grappe-les-unités-sont-randomisées-par-grappe-pour-le-traitement">Dans les expériences aléatoires par grappe, les unités sont randomisées par grappe pour le traitement</a></li>
<li><a href="#/estimation-de-late-dans-des-expériences-aléatoires-par-grappe">Estimation de l’ATE dans des expériences aléatoires par grappe</a></li>
<li><a href="#/estimation-de-lerreur-type-pour-late-dans-des-expériences-aléatoires-par-grappe">Estimation de l’erreur type pour l’ATE dans des expériences aléatoires par grappe</a></li>
<li><a href="#/un-exemple-destimation">Un exemple d’estimation</a></li>
<li><a href="#/un-exemple-destimation-1">Un exemple d’estimation</a></li>
<li><a href="#/simuler-pour-évaluer-les-estimateurs-et-les-tests">Simuler pour évaluer les estimateurs et les tests</a></li>
<li><a href="#/simuler-pour-évaluer-les-estimateurs-et-les-tests-1">Simuler pour évaluer les estimateurs et les tests</a></li>
<li><a href="#/simuler-pour-évaluer-les-estimateurs-et-les-tests-2">Simuler pour évaluer les estimateurs et les tests</a></li>
<li><a href="#/résumé-de-lestimation-et-des-tests-dans-les-essais-aléatoires-par-grappe">Résumé de l’estimation et des tests dans les essais aléatoires par grappe</a></li>
</ul></li>
<li><a href="#/résultats-binaires">Résultats binaires</a>
<ul>
<li><a href="#/résultats-binaires-configurons-nos-données-pour-simuler-avec-declaredesign">Résultats binaires : configurons nos données pour simuler avec DeclareDesign</a></li>
<li><a href="#/résultats-binaires-configurons-nos-données-pour-simuler-avec-declaredesign-1">Résultats binaires : configurons nos données pour simuler avec DeclareDesign</a></li>
<li><a href="#/résultats-binaires-paramètres-i">Résultats binaires : paramètres I</a></li>
<li><a href="#/résultats-binaires-paramètres-ii">Résultats binaires : paramètres II</a></li>
<li><a href="#/résultats-binaires-paramètres-iii">Résultats binaires : paramètres III</a></li>
<li><a href="#/un-exemple-destimation-i">Un exemple d’estimation I</a></li>
<li><a href="#/un-exemple-destimation-ii">Un exemple d’estimation II</a></li>
<li><a href="#/un-exemple-destimation-iii">Un exemple d’estimation III</a></li>
<li><a href="#/un-exemple-destimation-les-estimateurs-de-plugin-freedman-i">Un exemple d’estimation : les estimateurs de plugin Freedman I</a></li>
<li><a href="#/un-exemple-destimation-les-estimateurs-de-plugin-freedman-ii">Un exemple d’estimation : les estimateurs de plugin Freedman II</a></li>
<li><a href="#/un-exemple-avec-declaredesign-pour-évaluer-nos-estimateurs-i">Un exemple avec DeclareDesign pour évaluer nos estimateurs I</a></li>
<li><a href="#/un-exemple-avec-declaredesign-pour-évaluer-nos-estimateurs-ii">Un exemple avec DeclareDesign pour évaluer nos estimateurs II</a></li>
<li><a href="#/simuler-pour-évaluer-nos-estimateurs">Simuler pour évaluer nos estimateurs</a></li>
<li><a href="#/quel-estimateur-est-le-plus-proche-de-la-vérité-2">Quel estimateur est le plus proche de la vérité ?</a></li>
</ul></li>
<li><a href="#/autres-sujets-liés-à-lestimation">Autres sujets liés à l’estimation</a>
<ul>
<li><a href="#/lajustement-de-covariable-paramètres">L’ajustement de covariable : paramètres</a></li>
</ul></li>
<li><a href="#/conclusion">Conclusion</a>
<ul>
<li><a href="#/réflexions-finales-sur-lestimation">Réflexions finales sur l’estimation</a></li>
</ul></li>
<li><a href="#/effets-causaux-qui-diffèrent-selon-les-groupes-ou-covariables">Effets causaux qui diffèrent selon les groupes ou covariables</a>
<ul>
<li><a href="#/effets-différents-selon-les-groupes-i">Effets différents selon les groupes I</a></li>
<li><a href="#/effets-différents-selon-les-groupes-ii">Effets différents selon les groupes II</a></li>
</ul></li>
<li><a href="#/effets-causaux-quand-on-ne-contrôle-pas-la-dose">Effets causaux quand on ne contrôle pas la dose</a>
<ul>
<li><a href="#/définir-leffet-causal-i">Définir l’effet causal I</a></li>
<li><a href="#/définir-leffet-causal-ii">Définir l’effet causal II</a></li>
<li><a href="#/définir-leffet-causal-iii">Définir l’effet causal III</a></li>
<li><a href="#/définir-leffet-causal-iv">Définir l’effet causal IV</a></li>
<li><a href="#/définir-leffet-causal-v">Définir l’effet causal V</a></li>
<li><a href="#/définir-leffet-causal-vi">Définir l’effet causal VI</a></li>
<li><a href="#/définir-leffet-causal-vii">Définir l’effet causal VII</a></li>
<li><a href="#/comprendre-litt-i">Comprendre l’ITT I</a></li>
<li><a href="#/comprendre-litt-ii">Comprendre l’ITT II</a></li>
<li><a href="#/comprendre-litt">Comprendre l’ITT</a></li>
<li><a href="#/comprendre-litt-iv">Comprendre l’ITT IV</a></li>
<li><a href="#/leffet-causal-moyen-pour-ceux-qui-se-conforment-au-traitement-i">L’effet causal moyen pour ceux qui se conforment au traitement I</a></li>
<li><a href="#/leffet-causal-moyen-pour-ceux-qui-se-conforment-au-traitement-ii">L’effet causal moyen pour ceux qui se conforment au traitement II</a></li>
<li><a href="#/comment-calculer-litt-et-le-cacelate-i">Comment calculer l’ITT et le CACE/LATE I</a></li>
<li><a href="#/comment-calculer-litt-et-le-cacelate-ii">Comment calculer l’ITT et le CACE/LATE II</a></li>
<li><a href="#/comment-calculer-litt-et-le-cacelate-iii">Comment calculer l’ITT et le CACE/LATE III</a></li>
<li><a href="#/résumé-des-conceptions-incitatives-conformistes-par-dose">Résumé des conceptions incitatives / conformistes / par dose:</a></li>
<li><a href="#/références">Références</a></li>
</ul></li>
</ul>
</section>

<section>
<section id="points-clés" class="title-slide slide level1">
<h1>Points clés</h1>

</section>
<section id="points-clés-sur-lestimation-i" class="slide level2">
<h2>Points clés sur l’estimation I</h2>
<ul>
<li><p>Un effet causal, <span class="math inline">\(\tau_i\)</span>, est une comparaison des résultats potentiels non observés pour chaque unité <span class="math inline">\(i\)</span> : exemples <span class="math inline">\(\tau_{i} = Y_{i}(T_{i}=1) - Y_{i}(T_{i}=0)\)</span> ou <span class="math inline">\(\tau_{i} = \frac{Y_{i}(T_{i}=1)}{ Y_{i}(T_{i}=0)}\)</span>.</p></li>
<li><p>Pour en savoir plus sur <span class="math inline">\(\tau_{i}\)</span>, nous pouvons traiter <span class="math inline">\(\tau_{i}\)</span> comme un <strong>paramètre</strong> ou une quantité cible à estimer (discutée ici) ou comme quantité cible hypothétique (voir module sur les tests d’hypothèses).</p></li>
<li><p>Beaucoup se concentrent sur l’<strong>effet moyen du traitement (average treatment effect, ATE)</strong>, <span class="math inline">\(\bar{\tau}=\sum_{i=1}^n\tau_{i}\)</span>, en partie parce qu’il permet une <strong>estimation</strong> facile.</p></li>
</ul>
</section>
<section id="points-clés-sur-lestimation-ii" class="slide level2">
<h2>Points clés sur l’estimation II</h2>
<ul>
<li><p>La clé de l’estimation pour l’inférence causale consiste à choisir un paramètre qui vous aide à en savoir plus sur votre question théorique ou politique. Ainsi, on pourrait utiliser l’ATE mais aussi d’autres paramètres courants tels que l’effet d’intention de traiter (intent to treat effect, ITT), l’effet moyen local du traitement (local average treatment effect, LATE), l’effet causal moyen pour ceux qui se conforment au traitement (complier average causal effect, CACE), l’effet moyen du traitement sur les traités (average treatment effect on the treated, ATT) ou l’ATE pour certains sous-groupes.</p></li>
<li><p>Un <strong>estimateur</strong> est une recette pour calculer approximativement la valeur d’un paramètre. Par exemple, la différence des moyennes observées pour <span class="math inline">\(m\)</span> unités traitées est un estimateur de <span class="math inline">\(\bar{\tau}\)</span>: <span class="math inline">\(\hat{\bar{\tau}} = \frac{\sum_{i=1}^n (T_i Y_i)}{m} - \frac{\sum_{i=1}^n ( ( 1 - T_i)Y_i)}{(n-m)}\)</span>.</p></li>
</ul>
</section>
<section id="points-clés-sur-lestimation-iii" class="slide level2">
<h2>Points clés sur l’estimation III</h2>
<ul>
<li><p>L’<strong>erreur type</strong> d’un estimateur dans une expérience aléatoire résume comment les estimations varieraient si l’expérience était répétée.</p></li>
<li><p>Nous utilisons l’<strong>erreur type</strong> pour produire des <strong>intervalles de confiance</strong> et des <strong>p-valeurs</strong> afin de commencer par un estimateur et terminer par un test d’hypothèse.</p></li>
<li><p>Différentes randomisations produiront différentes valeurs du même estimateur ciblant le même paramètre. L’<strong>erreur type</strong> résume la variabilité de cet estimateur.</p></li>
<li><p>Un <strong>intervalle de confiance</strong> de <em><span class="math inline">\(100(1-\alpha)\)</span>%</em> est un ensemble d’hypothèses qui ne peuvent être rejetées au niveau <span class="math inline">\(\alpha\)</span>. Nous avons tendance à rapporter des intervalles de confiance contenant des hypothèses sur les valeurs de notre paramètre et à utiliser notre estimateur comme une statistique de test.</p></li>
</ul>
</section>
<section id="points-clés-sur-lestimation-iv" class="slide level2">
<h2>Points clés sur l’estimation IV</h2>
<ul>
<li><p>Les estimateurs doivent :</p>
<ul>
<li><p>éviter l’erreur systématique dans leur approximation du paramètre (i.e. être sans biais)</p></li>
<li><p>peu varier d’une expérience à l’autre (être précis ou efficace)</p></li>
<li><p>peut-être idéalement converger vers le paramètre quand ils utilisent de plus en plus d’informations (être cohérent).</p></li>
</ul></li>
</ul>
</section>
<section id="points-clés-sur-lestimation-v" class="slide level2">
<h2>Points clés sur l’estimation V</h2>
<ul>
<li><p><strong>Analyser au fur et à mesure de la randomisation</strong> dans le contexte de l’estimation signifie que (1) nos erreurs types doivent mesurer la variabilité à partir de la randomisation et (2) nos estimateurs doivent cibler des paramètres définis en termes de résultats potentiels.</p></li>
<li><p>Nous ne <strong>contrôlons pas</strong> les covariables lorsque nous analysons les données d’expériences aléatoires. Mais les covariables peuvent rendre notre estimation plus <strong>précise</strong>. C’est ce qu’on appelle <strong>l’ajustement de covariance</strong> (ou ajustement de covariable). <strong>L’ajustement de covariance</strong> dans les expériences aléatoires diffère du contrôle dans les études observationnelles.</p></li>
</ul>
</section></section>
<section>
<section id="revue" class="title-slide slide level1">
<h1>Revue</h1>

</section>
<section id="revue-effet-causal" class="slide level2">
<h2>Revue : effet causal</h2>
<p>L’inférence causale fait référence à la comparaison de résultats potentiels non observés, fixes.</p>
<p>Par exemple :</p>
<ul>
<li>le résultat potentiel de l’unité <span class="math inline">\(i\)</span> lorsqu’elle est assignée au traitement, <span class="math inline">\(T_i=1\)</span> est <span class="math inline">\(Y_{i}(T_{i}=1)\)</span>.</li>
<li>le résultat potentiel de l’unité <span class="math inline">\(i\)</span> lorsqu’elle est assignée au contrôle, <span class="math inline">\(T_i=0\)</span> est <span class="math inline">\(Y_{i}(T_{i}=0)\)</span>.</li>
</ul>
<p>L’assignation de traitement, <span class="math inline">\(T_i\)</span>, a un effet causal sur l’unité <span class="math inline">\(i\)</span>, que nous appelons <span class="math inline">\(\tau_i\)</span>, si <span class="math inline">\(Y_{i}(T_{i}=1) - Y_{i}(T_{i}=0) \ne 0\)</span> ou <span class="math inline">\(Y_{i}(T_{i}=1) \ne Y_{i}(T_{i}=0)\)</span>.</p>
</section></section>
<section>
<section id="paramètres-estimateurs-et-moyennes" class="title-slide slide level1">
<h1>Paramètres, estimateurs et moyennes</h1>

</section>
<section id="comment-en-savoir-plus-sur-les-effets-causaux-à-partir-des-données-observées" class="slide level2">
<h2>Comment en savoir plus sur les effets causaux à partir des données observées ?</h2>
<ol type="1">
<li><p>Rappel : nous pouvons <strong>tester les hypothèses</strong> sur la paire de résultats potentiels <span class="math inline">\(\{ Y_{i}(T_{i}=1), Y_{i}(T_{i}=0) \}\)</span>.</p></li>
<li><p>Nous pouvons <strong>définir les paramètres</strong> en termes de <span class="math inline">\(\{ Y_{i}(T_{i}=1), Y_{i}(T_{i}=0) \}\)</span> ou <span class="math inline">\(\tau_i\)</span>, <strong>développer des estimateurs</strong> pour ces paramètres, puis calculer les valeurs et les erreurs types pour ces estimateurs.</p></li>
</ol>
</section>
<section id="un-paramètre-et-un-estimateur-usuels-leffet-moyen-du-traitement-et-la-différence-des-moyennes" class="slide level2">
<h2>Un paramètre et un estimateur usuels : l’effet moyen du traitement et la différence des moyennes</h2>
<p>Soit <span class="math inline">\(\bar{\tau}=\sum_{i=1}^n \tau_{i}\)</span>, l’effet moyen du traitement. Quel serait un bon estimateur ?</p>
<p>Deux candidats :</p>
<ol type="1">
<li><p>La différence des moyennes : <span class="math inline">\(\hat{\bar{\tau}} = \frac{\sum_{i=1}^n (T_i Y_i)}{m} - \frac{\sum_{i=1}^n ( ( 1 - T_i) Y_i)}{n-m}\)</span>.</p></li>
<li><p>La différence des moyennes avec plafonnement de l’observation <span class="math inline">\(Y_i\)</span> la plus haute (une sorte de moyenne “winsorisée” pour éviter que les valeurs extrêmes n’exercent trop d’influence sur notre estimateur — pour augmenter la <em>précision</em>).</p></li>
</ol>
<p>Comment saurons-nous quel estimateur convient le mieux à notre conception de recherche ?</p>
<p>Simulons-le !</p>
</section>
<section id="étape-1-de-la-simulation-créer-des-données-avec-un-ate-connu" class="slide level2">
<h2>Étape 1 de la simulation : créer des données avec un ATE connu</h2>
<p>Notez que nous devons <em>connaître</em> les résultats potentiels et l’assignation de traitement afin de savoir si notre estimateur performe bien.</p>
<pre><code>Le vrai ATE est 54</code></pre>
<p>En réalité, nous n’observons qu’un seul des résultats potentiels.</p>
<p>Notez que chaque unité a son propre effet de traitement.</p>
</section>
<section id="commencez-par-créer-de-fausses-données" class="slide level2">
<h2>Commencez par créer de fausses données</h2>
<p>Le tableau de la slide précédente a été généré en R avec :</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nous avons dix unités</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  y0 est le résultat potentiel du contrôle</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">190</span>, <span class="dv">200</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Chaque unité a son propre effet de traitement</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">200</span>, <span class="dv">90</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">90</span>, <span class="dv">20</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># y1 est le résultat potentiel du traitement</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> y0 <span class="sc">+</span> tau</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 blocs, a et b</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>block <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;b&quot;</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Z est l&#39;assignation de traitement (notez que nous utilisons Z au lieu de T)</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Y est le résultat observé</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> Z <span class="sc">*</span> y1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> Z) <span class="sc">*</span> y0</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Les données</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Z =</span> Z, <span class="at">y0 =</span> y0, <span class="at">y1 =</span> y1, <span class="at">tau =</span> tau, <span class="at">b =</span> block, <span class="at">Y =</span> Y)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span></code></pre></div>
</section>
<section id="avec-declaredesign" class="slide level2">
<h2>Avec DeclareDesign</h2>
<p>DeclareDesign représente les conceptions de recherche en quelques étapes illustrées ci-dessous :</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prendre uniquement les résultats potentiels du traitement</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># et du contrôle à partir de nos fausses données</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>small_dat <span class="ot">&lt;-</span> dat[, <span class="fu">c</span>(<span class="st">&quot;y0&quot;</span>, <span class="st">&quot;y1&quot;</span>)]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># DeclareDesign vous demande d&#39;abord de déclarer votre population</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> <span class="fu">declare_population</span>(small_dat)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(small_dat)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 5 unités assignées au traitement ; la valeur par défaut</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># est l&#39;assignation aléatoire simple avec une probabilité de 0,5</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>trt_assign <span class="ot">&lt;-</span> <span class="fu">declare_assignment</span>(<span class="at">Z =</span> <span class="fu">conduct_ra</span>(<span class="at">N =</span> N, <span class="at">m =</span> <span class="dv">2</span>), <span class="at">legacy =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Y observé est y1 si Z=1 et y0 si Z=0</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>pot_out <span class="ot">&lt;-</span> <span class="fu">declare_potential_outcomes</span>(Y <span class="sc">~</span> Z <span class="sc">*</span> y1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> Z) <span class="sc">*</span> y0)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># spécifier les variables de résultat et d&#39;assignation</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>reveal <span class="ot">&lt;-</span> <span class="fu">declare_reveal</span>(Y, Z)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co"># l&#39;objet de conception de recherche basique comprend ces quatre objets</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>base_design <span class="ot">&lt;-</span> pop <span class="sc">+</span> trt_assign <span class="sc">+</span> pot_out <span class="sc">+</span> reveal</span></code></pre></div>
</section>
<section id="avec-declaredesign-créer-de-fausses-données" class="slide level2">
<h2>Avec DeclareDesign : créer de fausses données</h2>
<p>DeclareDesign renomme par défaut <code>y0</code> et <code>y1</code> : <code>Y_Z_0</code> et <code>Y_Z_1</code> :</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Une simulation est une assignation de traitement aléatoire</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>sim_dat1 <span class="ot">&lt;-</span> <span class="fu">draw_data</span>(base_design)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Données simulées (seulement les 6 premières lignes)</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sim_dat1)</span></code></pre></div>
<pre><code>  y0  y1 Z Y_Z_0 Y_Z_1  Y
1  0  10 0     0    10  0
2  0  30 1     0    30 30
3  0 200 0     0   200  0
4  1  91 0     1    91  1
5  1  11 0     1    11  1
6  3  23 1     3    23 23</code></pre>
</section>
<section id="avec-declaredesign-définir-le-paramètre-et-les-estimateurs" class="slide level2">
<h2>Avec DeclareDesign : définir le paramètre et les estimateurs</h2>
<p>Pas de sortie ici. Il suffit de définir fonctions et estimateurs ainsi qu’un paramètre.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Le paramètre</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>estimandATE <span class="ot">&lt;-</span> <span class="fu">declare_inquiry</span>(<span class="at">ATE =</span> <span class="fu">mean</span>(Y_Z_1 <span class="sc">-</span> Y_Z_0))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Le premier estimateur est la différence des moyennes</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>diff_means <span class="ot">&lt;-</span> <span class="fu">declare_estimator</span>(Y <span class="sc">~</span> Z,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">inquiry =</span> estimandATE,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> lm_robust, <span class="at">se_type =</span> <span class="st">&quot;classical&quot;</span>, <span class="at">label =</span> <span class="st">&quot;Diff des moyennes/MCO&quot;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</section>
<section id="avec-declaredesign-définir-le-paramètre-et-les-estimateurs-1" class="slide level2">
<h2>Avec DeclareDesign : définir le paramètre et les estimateurs</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Le deuxième estimateur est la différence des moyennes winsorisées</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>diff_means_topcoded_fn <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>rankY <span class="ot">&lt;-</span> <span class="fu">rank</span>(data<span class="sc">$</span>Y)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Remplacer la valeur maximale de Y par la seconde valeur maximale de Y</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>newY <span class="ot">&lt;-</span> <span class="fu">with</span>(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    data,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(rankY <span class="sc">==</span> <span class="fu">max</span>(rankY), Y[rankY <span class="sc">==</span> (<span class="fu">max</span>(rankY) <span class="sc">-</span> <span class="dv">1</span>)], Y)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  obj <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(newY <span class="sc">~</span> Z, <span class="at">data =</span> data, <span class="at">se_type =</span> <span class="st">&quot;classical&quot;</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">tidy</span>(obj) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">&quot;Z&quot;</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>diff_means_topcoded <span class="ot">&lt;-</span> <span class="fu">declare_estimator</span>(</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">handler =</span> <span class="fu">label_estimator</span>(diff_means_topcoded_fn),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">inquiry =</span> estimandATE, <span class="at">label =</span> <span class="st">&quot;Diff des moyennes winsorisée&quot;</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</section>
<section id="avec-declaredesign-définir-le-paramètre-et-les-estimateurs-2" class="slide level2">
<h2>Avec DeclareDesign : définir le paramètre et les estimateurs</h2>
<p>Nous montrons ici comment fonctionnent les estimateurs avec la méthode des doubles différences en utilisant nos données simulées.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Démontrer que le paramètre fonctionne :</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">estimandATE</span>(sim_dat1)</span></code></pre></div>
<pre><code>  inquiry estimand
1     ATE       54</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Démontrer que les estimateurs estiment correctement</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimateur 1 (différence des moyennes)</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">diff_means</span>(sim_dat1)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">11</span>)]</span></code></pre></div>
<pre><code>  estimate std.error statistic p.value conf.low conf.high df
1   -23.62     66.18    -0.357  0.7304   -176.2       129  8</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimateur 2 (différence des moyennes winsorisée)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">diff_means_topcoded</span>(sim_dat1)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">11</span>)]</span></code></pre></div>
<pre><code>  estimate std.error statistic p.value conf.low conf.high df
1   -22.37     64.44   -0.3472  0.7374     -171     126.2  8</code></pre>
</section>
<section id="puis-simuler-avec-une-randomisation" class="slide level2">
<h2>Puis simuler avec une randomisation</h2>
<p>Rappelons le vrai ATE :</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>trueATE <span class="ot">&lt;-</span> <span class="fu">with</span>(sim_dat1, <span class="fu">mean</span>(y1 <span class="sc">-</span> y0))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(sim_dat1, <span class="fu">mean</span>(Y_Z_1 <span class="sc">-</span> Y_Z_0))</span></code></pre></div>
<pre><code>[1] 54</code></pre>
<p>Dans une expérience (une simulation des données), voici les estimations simples :</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Deux façons de calculer l&#39;estimateur de la différence des moyennes</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>est_diff_means_1 <span class="ot">&lt;-</span> <span class="fu">with</span>(sim_dat1, <span class="fu">mean</span>(Y[Z <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">mean</span>(Y[Z <span class="sc">==</span> <span class="dv">0</span>]))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>est_diff_means_2 <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">lm_robust</span>(Y <span class="sc">~</span> Z,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> sim_dat1,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="st">&quot;classical&quot;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>))[[<span class="st">&quot;Z&quot;</span>]]</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(est_diff_means_1, est_diff_means_2)</span></code></pre></div>
<pre><code>[1] -23.62 -23.62</code></pre>
</section>
<section id="puis-simuler-avec-une-randomisation-1" class="slide level2">
<h2>Puis simuler avec une randomisation</h2>
<p>Dans une expérience (une simulation des données), voici les estimations après winsorisation :</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 façons de calculer l&#39;estimateur de la différence des moyennes winsorisées</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>sim_dat1<span class="sc">$</span>rankY <span class="ot">&lt;-</span> <span class="fu">rank</span>(sim_dat1<span class="sc">$</span>Y)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>sim_dat1<span class="sc">$</span>Y_tc <span class="ot">&lt;-</span> <span class="fu">with</span>(sim_dat1, <span class="fu">ifelse</span>(rankY <span class="sc">==</span> <span class="fu">max</span>(rankY),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  Y[rankY <span class="sc">==</span> (<span class="fu">max</span>(rankY) <span class="sc">-</span> <span class="dv">1</span>)], Y</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>est_topcoded_1 <span class="ot">&lt;-</span> <span class="fu">with</span>(sim_dat1, <span class="fu">mean</span>(Y_tc[Z <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">mean</span>(Y_tc[Z <span class="sc">==</span> <span class="dv">0</span>]))</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>est_topcoded_2 <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">lm_robust</span>(Y_tc <span class="sc">~</span> Z,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> sim_dat1,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> <span class="st">&quot;classical&quot;</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>))[[<span class="st">&quot;Z&quot;</span>]]</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(est_topcoded_1, est_topcoded_2)</span></code></pre></div>
<pre><code>[1] -22.38 -22.37</code></pre>
</section>
<section id="ensuite-simuler-une-randomisation-différente-et-estimer-late-avec-les-mêmes-estimateurs" class="slide level2">
<h2>Ensuite simuler une randomisation différente et estimer l’ATE avec les mêmes estimateurs</h2>
<p>Calculez maintenant votre estimation avec les mêmes estimateurs en utilisant une randomisation <strong>différente</strong>. Notez que les réponses diffèrent. Les estimateurs estiment le <em>même paramètre</em> mais ils travaillent maintenant avec une randomisation différente.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># faire une autre assignation aléatoire du traitement dans DeclareDesign</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># cela produit un nouveau jeu de données simulées</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># avec une assignation aléatoire différente</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>sim_dat2 <span class="ot">&lt;-</span> <span class="fu">draw_data</span>(base_design)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># le premier estimateur (différence des moyennes)</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm_robust</span>(Y <span class="sc">~</span> Z, <span class="at">data =</span> sim_dat2, <span class="at">se =</span> <span class="st">&quot;classical&quot;</span>))[[<span class="st">&quot;Z&quot;</span>]]</span></code></pre></div>
<pre><code>[1] -18</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># le second estimateur (différence des moyennes winsorisées)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>sim_dat2<span class="sc">$</span>rankY <span class="ot">&lt;-</span> <span class="fu">rank</span>(sim_dat2<span class="sc">$</span>Y)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>sim_dat2<span class="sc">$</span>Y_tc <span class="ot">&lt;-</span> <span class="fu">with</span>(sim_dat2, <span class="fu">ifelse</span>(rankY <span class="sc">==</span> <span class="fu">max</span>(rankY),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  Y[rankY <span class="sc">==</span> (<span class="fu">max</span>(rankY) <span class="sc">-</span> <span class="dv">1</span>)], Y</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm_robust</span>(Y_tc <span class="sc">~</span> Z, <span class="at">data =</span> sim_dat2, <span class="at">se =</span> <span class="st">&quot;classical&quot;</span>))[[<span class="st">&quot;Z&quot;</span>]]</span></code></pre></div>
<pre><code>[1] -16.75</code></pre>
</section>
<section id="comment-nos-estimateurs-se-comportent-ils-en-général-pour-cette-conception" class="slide level2">
<h2>Comment nos estimateurs se comportent-ils en général pour cette conception ?</h2>
<p>Nos estimations varient selon la randomisation. Nos deux estimateurs varient-ils de la même façon ?</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Combiner dans un seul objet DeclareDesign</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Cela contient la conception de base, le paramètre, puis nos deux estimateurs (diff_means et diff_means_topcoded)</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>design_plus_ests <span class="ot">&lt;-</span> base_design <span class="sc">+</span> estimandATE <span class="sc">+</span> diff_means <span class="sc">+</span> diff_means_topcoded</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Exécuter 100 simulations (réassignations de traitement) et</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="do">## appliquer les deux estimateurs</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>diagnosis1 <span class="ot">&lt;-</span> <span class="fu">diagnose_design</span>(design_plus_ests,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">bootstrap_sims =</span> <span class="dv">0</span>, <span class="at">sims =</span> <span class="dv">100</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>sims1 <span class="ot">&lt;-</span> <span class="fu">get_simulations</span>(diagnosis1)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sims1[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)])</span></code></pre></div>
<pre><code>  estimate std.error statistic p.value conf.low conf.high df outcome
1   -18.00     66.23  -0.27179  0.7927   -170.7     134.7  8       Y
2   -16.75     64.49  -0.25974  0.8016   -165.5     132.0  8    newY
3     0.75     67.98   0.01103  0.9915   -156.0     157.5  8       Y
4     2.00     66.29   0.03017  0.9767   -150.9     154.9  8    newY
5    54.50     75.93   0.71775  0.4933   -120.6     229.6  8       Y
6   -19.14     75.85  -0.25237  0.8092   -204.7     166.5  6    newY</code></pre>
</section>
<section id="comment-nos-estimateurs-se-comportent-ils-en-général-pour-cette-conception-1" class="slide level2">
<h2>Comment nos estimateurs se comportent-ils en général pour cette conception ?</h2>
<p>Nos estimations varient selon la randomisation. Nos deux estimateurs varient-ils de la même façon ? Comment interpréter cette figure ?</p>
<p><img src="figs/figsim_plot-1.png" width=".8\textwidth"  /></p>
</section>
<section id="quel-estimateur-est-le-plus-proche-de-la-vérité" class="slide level2">
<h2>Quel estimateur est le plus proche de la vérité ?</h2>
<p>Une façon de choisir parmi les estimateurs est de choisir celui qui est <strong>proche de la vérité</strong> chaque fois que nous l’utilisons — quelle que soit la randomisation choisie.</p>
<p>Un estimateur “sans biais” est un estimateur pour lequel la <strong>moyenne des estimations pour des conceptions répétées</strong> est la même que la vérité (ou <span class="math inline">\(E_R(\hat{\bar{\tau}})=\bar{\tau}\)</span>). Un estimateur sans biais n’a “pas d’erreur systématique” mais ne garantit pas la proximité avec la vérité.</p>
<p>Une autre mesure de proximité est la <strong>racine de l’erreur quadratique moyenne</strong> (REQM) qui agrège les distances au carré entre la vérité et les estimations individuelles.</p>
<p>Quel estimateur est le meilleur ? (L’un est plus proche de la vérité en moyenne (REQM) et il est plus précis. L’autre n’a pas d’erreur systématique — il est non-biaisé.)</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Estimator</th>
<th style="text-align: left;">Bias</th>
<th style="text-align: left;">RMSE</th>
<th style="text-align: left;">SD Estimate</th>
<th style="text-align: left;">Mean Se</th>
<th style="text-align: left;">Power</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Diff des moyennes winsorisée</td>
<td style="text-align: left;">-25.50</td>
<td style="text-align: left;">64.86</td>
<td style="text-align: left;">59.94</td>
<td style="text-align: left;">64.53</td>
<td style="text-align: left;">0.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">Diff des moyennes/MCO</td>
<td style="text-align: left;">-5.70</td>
<td style="text-align: left;">71.23</td>
<td style="text-align: left;">71.36</td>
<td style="text-align: left;">66.54</td>
<td style="text-align: left;">0.09</td>
</tr>
</tbody>
</table>
</section>
<section id="estimateurs-biaisés-et-non-biaisés" class="slide level2">
<h2>Estimateurs biaisés et non-biaisés</h2>
<p>Résumé :</p>
<ul>
<li><p>Nous avons un <em>choix</em> de paramètres et d’estimateurs</p></li>
<li><p>Un bon estimateur performe bien quelle que soit la randomisation particulière d’une conception donnée. Et <em>bien performer</em> peut signifier “être sans biais” et/ou “avoir une faible erreur quadratique moyenne” (ou “être cohérent” — ce qui signifie être de plus en plus proche de la vérité à mesure que la taille de l’échantillon augmente).</p></li>
<li><p>Nous pouvons apprendre comment un estimateur donné se comporte dans une étude donnée en utilisant la simulation.</p></li>
</ul>
</section></section>
<section>
<section id="randomisation-par-bloc" class="title-slide slide level1">
<h1>Randomisation par bloc</h1>

</section>
<section id="les-expériences-aléatoires-par-bloc-sont-une-collection-de-mini-expériences" class="slide level2">
<h2>Les expériences aléatoires par bloc sont une collection de mini-expériences</h2>
<p>Quel est le paramètre de l’<strong>effet moyen du traitement</strong> dans une expérience aléatoire par bloc ?</p>
<p>Si nous considérons l’ATE au niveau de l’unité comme : <span class="math inline">\((1/N) \sum_{i=1}^N y_{i,1} - y_{i,0}\)</span> alors nous pourrions réexprimer cela de manière équivalente en sachant que l’ATE par bloc <span class="math inline">\(j\)</span> est <span class="math inline">\(ATE_j\)</span> comme suit :</p>
<p><span class="math display">\[
ATE = \frac{1}{J}\sum^J_{j=1} \sum^{N_j}_{i=1} \frac{y_{i,1} - y_{i,0}}{N_j}  = \sum^J_{j=1} \frac{N_j}{N} ATE_j
\]</span></p>
<p>Et il serait naturel d’<em>estimer</em> cette quantité en y introduisant ce qu’on peut calculer : <span class="math inline">\(\widehat{ATE} = \displaystyle\sum^J_{j=1} \frac{N_j}{N} \widehat{ATE}_j\)</span></p>
</section>
<section id="les-expériences-aléatoires-par-bloc-sont-une-collection-de-mini-expériences-1" class="slide level2">
<h2>Les expériences aléatoires par bloc sont une collection de mini-expériences</h2>
<p>Et nous pourrions <em>définir</em> l’erreur type de l’estimateur en faisant la moyenne intra-bloc des erreurs types (si nos blocs sont suffisamment grands) :</p>
<p><span class="math inline">\(SE(\widehat{ATE}) = \sqrt{\sum^J_{j=1} (\frac{N_{j}}{N})^2SE^2(\widehat{ATE}_j)}\)</span></p>
</section>
<section id="estimer-late-dans-les-expériences-aléatoires-par-bloc" class="slide level2">
<h2>Estimer l’ATE dans les expériences aléatoires par bloc</h2>
<p>Une approche de l’estimation remplace simplement <span class="math inline">\(ATE_j\)</span> par <span class="math inline">\(\widehat{ATE}\)</span> ci-dessous :</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(dat, <span class="fu">table</span>(b, Z))</span></code></pre></div>
<pre><code>   Z
b   0 1
  a 4 2
  b 2 2</code></pre>
<p>Nous avons 6 unités dans le bloc <code>a</code>, dont 2 sont assignées au traitement et 4 unités dans le bloc <code>b</code>, dont 2 sont assignées au traitement.</p>
</section>
<section id="estimer-late-dans-les-expériences-aléatoires-par-bloc-1" class="slide level2">
<h2>Estimer l’ATE dans les expériences aléatoires par bloc</h2>
<p>Une approche de l’estimation remplace simplement <span class="math inline">\(ATE_j\)</span> par <span class="math inline">\(\widehat{ATE}\)</span> ci-dessus :</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>datb <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(b) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">nb =</span> <span class="fu">n</span>(), <span class="at">pb =</span> <span class="fu">mean</span>(Z), <span class="at">estateb =</span> <span class="fu">mean</span>(Y[Z <span class="sc">==</span> <span class="dv">1</span>]) <span class="sc">-</span> <span class="fu">mean</span>(Y[Z <span class="sc">==</span> <span class="dv">0</span>]),</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ateb =</span> <span class="fu">mean</span>(y1 <span class="sc">-</span> y0), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>datb</span></code></pre></div>
<pre><code># A tibble: 2 x 5
  b        nb    pb estateb  ateb
  &lt;chr&gt; &lt;int&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 a         6 0.333    16.8    60
2 b         4 0.5     246.     45</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">## le vrai ATE par bloc :</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(dat, <span class="fu">mean</span>(y1 <span class="sc">-</span> y0))</span></code></pre></div>
<pre><code>[1] 54</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Une autre façon de calculer le vrai ATE</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(datb, <span class="fu">sum</span>(ateb <span class="sc">*</span> (nb <span class="sc">/</span> <span class="fu">sum</span>(nb))))</span></code></pre></div>
<pre><code>[1] 54</code></pre>
</section>
<section id="estimer-late-dans-les-expériences-aléatoires-par-bloc-2" class="slide level2">
<h2>Estimer l’ATE dans les expériences aléatoires par bloc</h2>
<p>Une approche consiste à estimer l’ATE global pondéré par la taille de bloc :</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Montrer que la difference des moyennes est pondérée par la taille du bloc.</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> <span class="fu">difference_in_means</span>(Y <span class="sc">~</span> Z, <span class="at">blocks =</span> b, <span class="at">data =</span> dat)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>e2 <span class="ot">&lt;-</span> <span class="fu">with</span>(datb, <span class="fu">sum</span>(estateb <span class="sc">*</span> (nb <span class="sc">/</span> <span class="fu">sum</span>(nb))))</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">coef</span>(e1)[[<span class="st">&quot;Z&quot;</span>]], e2)</span></code></pre></div>
<pre><code>[1] 108.2 108.2</code></pre>
</section>
<section id="estimer-late-dans-les-expériences-aléatoires-par-bloc-3" class="slide level2">
<h2>Estimer l’ATE dans les expériences aléatoires par bloc</h2>
<p>Notez que ce n’est <strong>pas</strong> la même chose que les deux éléments suivants :</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="do">## En ignorant les blocs</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>e3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> Z, <span class="at">data =</span> dat)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(e3)[[<span class="st">&quot;Z&quot;</span>]]</span></code></pre></div>
<pre><code>[1] 131.8</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Avec les effets de blocs fixes</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>e4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> Z <span class="sc">+</span> block, <span class="at">data =</span> dat)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(e4)[[<span class="st">&quot;Z&quot;</span>]]</span></code></pre></div>
<pre><code>[1] 114.8</code></pre>
<p>En quoi diffèrent-ils ? (Le premier ignore les blocs. Le second utilise un ensemble différent de poids créés à l’aide d’indicateurs, de variables muettes ou de variables à “effets fixes.”)</p>
</section>
<section id="quel-estimateur-doit-on-utiliser" class="slide level2">
<h2>Quel estimateur doit-on utiliser ?</h2>
<p>Nous avons maintenant 3 estimateurs, chacun avec une estimation différente (en imaginant qu’ils ciblent tous le même paramètre) :</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">coef</span>(e1)[[<span class="st">&quot;Z&quot;</span>]], <span class="fu">coef</span>(e3)[[<span class="st">&quot;Z&quot;</span>]], <span class="fu">coef</span>(e4)[[<span class="st">&quot;Z&quot;</span>]])</span></code></pre></div>
<pre><code>[1] 108.2 131.8 114.8</code></pre>
<p>Quel estimateur doit-on utiliser pour cette conception ? Simulons avec DeclareDesign pour le savoir.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">## déclarer une nouvelle conception de base qui inclut b, l&#39;indicateur de bloc</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>base_design_blocks <span class="ot">&lt;-</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">declare_population</span>(dat[, <span class="fu">c</span>(<span class="st">&quot;b&quot;</span>, <span class="st">&quot;y0&quot;</span>, <span class="st">&quot;y1&quot;</span>)]) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dire à la méthode des doubles différences que b signifie bloc</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># et assigner 2 unités au traitement dans chaque bloc</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">declare_assignment</span>(</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Z =</span> <span class="fu">conduct_ra</span>(<span class="at">N =</span> N, <span class="at">m =</span> <span class="dv">2</span>, <span class="at">blocks =</span> b),</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Z_cond_prob =</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">obtain_condition_probabilities</span>(<span class="at">assignment =</span> Z, <span class="at">m =</span> <span class="dv">2</span>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># relation entre les résultats potentiels et les résultats observés</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">declare_potential_outcomes</span>(Y <span class="sc">~</span> Z <span class="sc">*</span> y1 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> Z) <span class="sc">*</span> y0) <span class="sc">+</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># résultat observé et assignation de traitement</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">declare_reveal</span>(Y, Z)</span></code></pre></div>
</section>
<section id="quel-estimateur-doit-on-utiliser-1" class="slide level2">
<h2>Quel estimateur doit-on utiliser ?</h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Le paramètre est l&#39;effet moyen du traitement</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>estimandATEb <span class="ot">&lt;-</span> <span class="fu">declare_inquiry</span>(<span class="at">ATE =</span> <span class="fu">mean</span>(Y_Z_1 <span class="sc">-</span> Y_Z_0))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 estimateurs différents</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>est1 <span class="ot">&lt;-</span> <span class="fu">declare_estimator</span>(Y <span class="sc">~</span> Z,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">inquiry =</span> estimandATEb, <span class="at">model =</span> lm_robust,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">&quot;Ignore les blocs&quot;</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>est2 <span class="ot">&lt;-</span> <span class="fu">declare_estimator</span>(Y <span class="sc">~</span> Z,</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">inquiry =</span> estimandATEb, <span class="at">model =</span> difference_in_means, <span class="at">blocks =</span> b,</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">&quot;Diff des moyennes pondérée par bloc&quot;</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>est3 <span class="ot">&lt;-</span> <span class="fu">declare_estimator</span>(Y <span class="sc">~</span> Z,</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">inquiry =</span> estimandATEb, <span class="at">model =</span> lm_robust,</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> (Z <span class="sc">/</span> Z_cond_prob) <span class="sc">+</span> ((<span class="dv">1</span> <span class="sc">-</span> Z) <span class="sc">/</span> (Z_cond_prob)),</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">&quot;MCO pondérée par bloc&quot;</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</section>
<section id="quel-estimateur-doit-on-utiliser-2" class="slide level2">
<h2>Quel estimateur doit-on utiliser ?</h2>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># deux autres estimateurs</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>est4 <span class="ot">&lt;-</span> <span class="fu">declare_estimator</span>(Y <span class="sc">~</span> Z,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">inquiry =</span> estimandATEb,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> lm_robust, <span class="at">fixed_effects =</span> <span class="sc">~</span>b, <span class="at">label =</span> <span class="st">&quot;Pondérée par précision&quot;</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>est5 <span class="ot">&lt;-</span> <span class="fu">declare_estimator</span>(Y <span class="sc">~</span> Z <span class="sc">+</span> b,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">inquiry =</span> estimandATEb,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> lm_robust, <span class="at">label =</span> <span class="st">&quot;Pondérée par précision (LSDV)&quot;</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="do">## la nouvelle conception a la conception de base, le paramètre et cinq estimateurs</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>design_blocks <span class="ot">&lt;-</span> base_design_blocks <span class="sc">+</span> estimandATEb <span class="sc">+</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  est1 <span class="sc">+</span> est2 <span class="sc">+</span> est3 <span class="sc">+</span> est4 <span class="sc">+</span> est5</span></code></pre></div>
<p>Ensuite, nous allons exécuter 10 000 simulations (réassigner le traitement 10 000 fois) et résumer les estimations produites par chacun de ces cinq estimateurs.</p>
</section>
<section id="quel-estimateur-doit-on-utiliser-3" class="slide level2">
<h2>Quel estimateur doit-on utiliser ?</h2>
<p>Comment interpréter cette figure ?</p>
<p><img src="figs/figsim_plot2-1.png" width=".9\textwidth"  /></p>
</section>
<section id="quel-estimateur-est-le-plus-proche-de-la-vérité-1" class="slide level2">
<h2>Quel estimateur est le plus proche de la vérité ?</h2>
<p>Quel estimateur fonctionne le mieux pour cette conception et ces données ?</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Estimator</th>
<th style="text-align: left;">Bias</th>
<th style="text-align: left;">RMSE</th>
<th style="text-align: left;">SD Est</th>
<th style="text-align: left;">Mean SE</th>
<th style="text-align: left;">Power</th>
<th style="text-align: left;">Coverage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">DiM: Block-Size Weights</td>
<td style="text-align: left;">-0.63</td>
<td style="text-align: left;">53.08</td>
<td style="text-align: left;">53.11</td>
<td style="text-align: left;">51.90</td>
<td style="text-align: left;">0.22</td>
<td style="text-align: left;">0.77</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ignores Blocks</td>
<td style="text-align: left;">14.48</td>
<td style="text-align: left;">55.23</td>
<td style="text-align: left;">53.33</td>
<td style="text-align: left;">60.79</td>
<td style="text-align: left;">0.10</td>
<td style="text-align: left;">0.97</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LM: Block Size Weights</td>
<td style="text-align: left;">14.48</td>
<td style="text-align: left;">55.23</td>
<td style="text-align: left;">53.33</td>
<td style="text-align: left;">60.79</td>
<td style="text-align: left;">0.10</td>
<td style="text-align: left;">0.97</td>
</tr>
<tr class="even">
<td style="text-align: left;">Precision Weights</td>
<td style="text-align: left;">-1.02</td>
<td style="text-align: left;">55.39</td>
<td style="text-align: left;">55.40</td>
<td style="text-align: left;">56.96</td>
<td style="text-align: left;">0.11</td>
<td style="text-align: left;">0.92</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Precision Weights (LSDV)</td>
<td style="text-align: left;">-1.02</td>
<td style="text-align: left;">55.39</td>
<td style="text-align: left;">55.40</td>
<td style="text-align: left;">56.96</td>
<td style="text-align: left;">0.11</td>
<td style="text-align: left;">0.92</td>
</tr>
</tbody>
</table>
<p>Notez que la couverture n’est pas toujours à 95 % dans tous les cas. Nous avons simulé 10 000 fois, donc l’erreur de simulation est d’environ <span class="math inline">\(\pm 2 \sqrt{p(1-p)/10000}\)</span> ou, disons, pour une couverture calculée à 0,93, une simulation différente aurait pu facilement produire 0.9249 ou 0.9351 (ou la couverture sera rarement en dehors de cette plage juste par hasard).</p>
</section></section>
<section>
<section id="randomisation-par-grappe" class="title-slide slide level1">
<h1>Randomisation par grappe</h1>

</section>
<section id="dans-les-expériences-aléatoires-par-grappe-les-unités-sont-randomisées-par-grappe-pour-le-traitement" class="slide level2 allowframebreaks">
<h2 class="allowframebreaks">Dans les expériences aléatoires par grappe, les unités sont randomisées par grappe pour le traitement</h2>
<ul>
<li><p><strong>Exemple 1 :</strong> une intervention est randomisée entre les quartiers, donc <strong>tous</strong> les ménages d’un quartier seront assignés à la même condition de traitement, mais différents quartiers seront assignés à des conditions de traitement différentes.</p></li>
<li><p><strong>Exemple 2 :</strong> une intervention est randomisée sur plusieurs personnes et chaque personne est mesurée quatre fois après le traitement. Nos données contiennent donc quatre lignes par personne.</p></li>
<li><p><strong>Pas un exemple 1 :</strong> Les quartiers sont choisis pour l’étude. Dans chaque quartier, environ la moitié des personnes sont assignées au traitement et l’autre moitié au contrôle. (De quel type d’étude s’agit-il ? Ce n’est pas une étude randomisée par grappe.)</p></li>
<li><p><strong>Pas un exemple 2 :</strong> une intervention est randomisée à certains quartiers et pas à d’autres, les résultats incluent des mesures de la confiance au niveau du quartier envers le gouvernement et la superficie totale du quartier consacrée aux jardins. (Parfois, une expérience randomisée par grappe peut être transformée en une expérience randomisée simple. Ou elle peut contenir plus d’une approche possible d’analyse et d’interprétation.)</p></li>
</ul>
<p>En quoi la distribution des statistiques de test et des estimateurs peut-elle différer d’une expérience où des unités individuelles (et non des grappes) sont randomisées ?</p>
</section>
<section id="estimation-de-late-dans-des-expériences-aléatoires-par-grappe" class="slide level2">
<h2>Estimation de l’ATE dans des expériences aléatoires par grappe</h2>
<p>Problèmes de biais dans les expériences aléatoires par grappe :</p>
<ul>
<li><p>Lorsque les grappes ont la même taille, l’estimateur habituel de différences des moyennes est sans biais.</p></li>
<li><p>Mais soyez prudent lorsque les grappes ont des tailles différentes ou que vous avez très peu de grappes car les effets de traitement peuvent être corrélés à la taille des grappes.</p></li>
<li><p>Lorsque la taille de la grappe est liée aux résultats potentiels, l’estimateur habituel de différences des moyennes est biaisé. <a href="https://declaredesign.org/blog/bias-cluster-randomized-trials.html">Lien</a></p></li>
</ul>
</section>
<section id="estimation-de-lerreur-type-pour-late-dans-des-expériences-aléatoires-par-grappe" class="slide level2 allowframebreaks">
<h2 class="allowframebreaks">Estimation de l’erreur type pour l’ATE dans des expériences aléatoires par grappe</h2>
<ul>
<li><p><strong>Inférences statistiques trompeuses :</strong> L’erreur type par défaut sous-estimera généralement la précision dans de telles conceptions et produira ainsi des tests avec des taux de faux positifs trop élevés (ou, de manière équivalente, des taux de couverture pour les intervalles de confiance trop faibles).</p></li>
<li><p>“L’erreur type robuste pour grappe” implémentée dans les logiciels courants fonctionnent bien <strong>lorsque le nombre de grappes est important</strong> (plus de 50 grappes dans certaines études de simulation).</p></li>
<li><p>L’erreur type par défaut adaptée aux grappes dans <code>lm_robust</code> (l’erreur type <code>CR2</code>) fonctionne mieux que l’approche basique en Stata (à ce jour).</p></li>
<li><p>Le “wild bootstrap” aide à contrôler les taux d’erreur mais abandonne beaucoup plus de puissance statistique qu’il n’est peut-être nécessaire dans une étude aléatoire par grappe où l’inférence de randomisation directe est possible.</p></li>
<li><p>En cas de doute, on peut produire des <span class="math inline">\(p\)</span>-valeurs ​​par simulation directe (inférence de randomisation directe) pour voir si elles sont en accord avec l’une des approches robustes pour grappe (cluster).</p></li>
</ul>
<p>Globalement, cela vaut la peine de simuler pour étudier les performances de vos estimateurs, tests et intervalles de confiance si vous avez des inquiétudes ou des doutes.</p>
</section>
<section id="un-exemple-destimation" class="slide level2">
<h2>Un exemple d’estimation</h2>
<p>Imaginez que nous ayons des données de 10 grappes avec soit 100 personnes (pour 2 grappes) soit 10 personnes par grappe (pour 8 grappes). La taille totale des données est 280.</p>
<pre><code># A tibble: 6 x 10
# Groups:   clus_id [2]
  clus_id cl_size cl_sizeF effect indiv     u Y_Z_0 Y_Z_1     Z     Y
  &lt;chr&gt;     &lt;dbl&gt; &lt;fct&gt;     &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
1 01          100 100         0.1 010    4.51  4.51  4.61     0  4.51
2 01          100 100         0.1 035    4.63  4.63  4.73     0  4.63
3 01          100 100         0.1 068    4.76  4.76  4.86     0  4.76
4 03           10 10          1   205    3.13  3.13  4.13     1  4.13
5 03           10 10          1   206    2.41  2.41  3.41     1  3.41
6 03           10 10          1   208    2.95  2.95  3.95     1  3.95</code></pre>
</section>
<section id="un-exemple-destimation-1" class="slide level2">
<h2>Un exemple d’estimation</h2>
<p>Quel estimateur doit-on utiliser ? Quel test doit-on utiliser ? Sur quelle base choisir parmi ces approches ?</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>lmc1 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(Y <span class="sc">~</span> Z, <span class="at">data =</span> dat1)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>lmc2 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(Y <span class="sc">~</span> Z, <span class="at">clusters =</span> clus_id, <span class="at">data =</span> dat1)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>lmc3 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(Y <span class="sc">~</span> Z <span class="sc">+</span> cl_sizeF, <span class="at">clusters =</span> clus_id, <span class="at">data =</span> dat1)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmc1)[<span class="dv">2</span>, ]</span></code></pre></div>
<pre><code>  term estimate std.error statistic p.value conf.low conf.high  df outcome
2    Z   0.3024    0.1207     2.504 0.01284  0.06471    0.5401 278       Y</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmc2)[<span class="dv">2</span>, ]</span></code></pre></div>
<pre><code>  term estimate std.error statistic p.value conf.low conf.high    df outcome
2    Z   0.3024     1.079    0.2804   0.796   -2.969     3.574 3.282       Y</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmc3)[<span class="dv">2</span>, ]</span></code></pre></div>
<pre><code>  term estimate std.error statistic p.value conf.low conf.high    df outcome
2    Z   0.3024     0.306    0.9882  0.4386   -1.194     1.799 1.769       Y</code></pre>
</section>
<section id="simuler-pour-évaluer-les-estimateurs-et-les-tests" class="slide level2">
<h2>Simuler pour évaluer les estimateurs et les tests</h2>
<p>Si vous regardez le code des slides, vous verrez que nous simulons la conception 5000 fois, en calculant à chaque fois une estimation et un intervalle de confiance pour différents estimateurs de l’ATE.</p>
<p>Que devons-nous apprendre de ce tableau ? (Couverture ? <code>sd_estimate</code> vs. <code>mean_se</code>).</p>
<table>
<caption>Performances de l’estimateur et des tests pour 5000 simulations de la conception randomisée par grappe pour différents estimateurs et intervalles de confiance</caption>
<thead>
<tr class="header">
<th style="text-align: left;">estimator</th>
<th style="text-align: right;">coverage</th>
<th style="text-align: right;">sd_estimate</th>
<th style="text-align: right;">mean_se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Y~Z*I(clus_size-mean(clus_size)), CR2</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">1.61</td>
<td style="text-align: right;">0.06</td>
</tr>
<tr class="even">
<td style="text-align: left;">Y~Z, cl_size fe, CR2</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">1.07</td>
<td style="text-align: right;">0.72</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Y~Z, fixed_effects=~clus_size_fixed_effects, CR2</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.30</td>
</tr>
<tr class="even">
<td style="text-align: left;">Y~Z, HC2</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">1.07</td>
<td style="text-align: right;">0.13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Y~Z, IID</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">1.07</td>
<td style="text-align: right;">0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">Y~Z*I(cl_size-mean(cl_size)), CR2</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">0.84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Y~Z+cl_sizeF, CR2</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.30</td>
</tr>
</tbody>
</table>
</section>
<section id="simuler-pour-évaluer-les-estimateurs-et-les-tests-1" class="slide level2">
<h2>Simuler pour évaluer les estimateurs et les tests</h2>
<p>Que devons-nous apprendre de ce tableau ? (Biais ? Proximité avec la vérité ?)</p>
<table>
<caption>Performances de l’estimateur et des tests pour 5000 simulations de la conception randomisée par grappe pour différents estimateurs et intervalles de confiance</caption>
<thead>
<tr class="header">
<th style="text-align: left;">estimator</th>
<th style="text-align: right;">bias</th>
<th style="text-align: right;">rmse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Y~Z*I(clus_size-mean(clus_size)), CR2</td>
<td style="text-align: right;">0.836</td>
<td style="text-align: right;">1.814</td>
</tr>
<tr class="even">
<td style="text-align: left;">Y~Z, cl_size fe, CR2</td>
<td style="text-align: right;">0.132</td>
<td style="text-align: right;">1.079</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Y~Z, fixed_effects=~clus_size_fixed_effects, CR2</td>
<td style="text-align: right;">0.278</td>
<td style="text-align: right;">0.448</td>
</tr>
<tr class="even">
<td style="text-align: left;">Y~Z, HC2</td>
<td style="text-align: right;">0.132</td>
<td style="text-align: right;">1.079</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Y~Z, IID</td>
<td style="text-align: right;">0.132</td>
<td style="text-align: right;">1.079</td>
</tr>
<tr class="even">
<td style="text-align: left;">Y~Z*I(cl_size-mean(cl_size)), CR2</td>
<td style="text-align: right;">-0.014</td>
<td style="text-align: right;">1.224</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Y~Z+cl_sizeF, CR2</td>
<td style="text-align: right;">0.278</td>
<td style="text-align: right;">0.448</td>
</tr>
</tbody>
</table>
</section>
<section id="simuler-pour-évaluer-les-estimateurs-et-les-tests-2" class="slide level2">
<h2>Simuler pour évaluer les estimateurs et les tests</h2>
<p>Comment interpréter cette figure ?</p>
<p><img src="figs/figsim_plot_clus-1.png" width=".95\textwidth"  /></p>
</section>
<section id="résumé-de-lestimation-et-des-tests-dans-les-essais-aléatoires-par-grappe" class="slide level2">
<h2>Résumé de l’estimation et des tests dans les essais aléatoires par grappe</h2>
<ul>
<li><p>Les essais aléatoires par grappe posent des problèmes particuliers pour les approches standard d’estimation et de test.</p></li>
<li><p>Si la randomisation est au niveau de la grappe, alors l’incertitude provient de la randomisation au niveau de la grappe.</p></li>
<li><p>Si nous avons suffisamment de grappes, alors “l’erreur type robuste pour grappe” peut nous aider à produire des intervalles de confiance avec une couverture correcte. <strong>L’erreur type robuste pour grappe nécessite de nombreux grappes</strong>.</p></li>
<li><p>Si la taille de la grappe (ou caractéristique) est liée à la taille de l’effet, alors nous pouvons avoir un biais (et nous devons ajuster d’une manière ou d’une autre).</p></li>
</ul>
</section></section>
<section>
<section id="résultats-binaires" class="title-slide slide level1">
<h1>Résultats binaires</h1>

</section>
<section id="résultats-binaires-configurons-nos-données-pour-simuler-avec-declaredesign" class="slide level2">
<h2>Résultats binaires : configurons nos données pour simuler avec DeclareDesign</h2>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># taille de la population</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># déclarer la population</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>thepop_bin <span class="ot">&lt;-</span> <span class="fu">declare_population</span>(</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> N, <span class="at">x1 =</span> <span class="fu">draw_binary</span>(<span class="at">prob =</span> .<span class="dv">5</span>, <span class="at">N =</span> N),</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">x2 =</span> <span class="fu">rnorm</span>(N)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co"># déclarer les résultats potentiels</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>thepo_bin <span class="ot">&lt;-</span> <span class="fu">declare_potential_outcomes</span>(Y <span class="sc">~</span> <span class="fu">rbinom</span>(</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> N, <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob =</span> <span class="fl">0.5</span> <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> Z <span class="sc">+</span> x1 <span class="sc">*</span> .<span class="dv">05</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="co"># deux cibles possibles : différences des moyennes et différence log-odds</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>thetarget_ate <span class="ot">&lt;-</span> <span class="fu">declare_inquiry</span>(<span class="at">ate =</span> <span class="fu">mean</span>(Y_Z_1 <span class="sc">-</span> Y_Z_0))</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>thetarget_logodds <span class="ot">&lt;-</span> <span class="fu">declare_inquiry</span>(</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">logodds =</span> <span class="fu">log</span>(<span class="fu">mean</span>(Y_Z_1) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">mean</span>(Y_Z_1))) <span class="sc">-</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(<span class="fu">mean</span>(Y_Z_0) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">mean</span>(Y_Z_0)))</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</section>
<section id="résultats-binaires-configurons-nos-données-pour-simuler-avec-declaredesign-1" class="slide level2">
<h2>Résultats binaires : configurons nos données pour simuler avec DeclareDesign</h2>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># déclarer comment le traitement est assigné</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># m unités sont assignées aux niveaux de traitement Z</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>theassign_bin <span class="ot">&lt;-</span> <span class="fu">declare_assignment</span>(<span class="at">Z =</span> <span class="fu">conduct_ra</span>(<span class="at">N =</span> N, <span class="at">m =</span> <span class="fu">floor</span>(N <span class="sc">/</span> <span class="dv">3</span>)))</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># déclarer quelles valeurs de résultat sont révélées</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># pour les valeurs possibles de Z</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>thereveal_bin <span class="ot">&lt;-</span> <span class="fu">declare_reveal</span>(Y, Z)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co"># combiner population, résultats potentiels, assignation</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co"># et valeurs de résultat liées à Z</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>des_bin <span class="ot">&lt;-</span> thepop_bin <span class="sc">+</span> thepo_bin <span class="sc">+</span> theassign_bin <span class="sc">+</span> thereveal_bin</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co"># puis faire un tirage (randomiser le traitement une fois)</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>dat2 <span class="ot">&lt;-</span> <span class="fu">draw_data</span>(des_bin)</span></code></pre></div>
</section>
<section id="résultats-binaires-paramètres-i" class="slide level2">
<h2>Résultats binaires : paramètres I</h2>
<p>Comment interpréterions-nous les vraies quantités ou paramètres suivants ? <code>Y_Z_1</code>, <code>Y_Z_0</code> sont des résultats potentiels, <code>Y</code> est l’observation, <code>x1</code>, <code>x2</code> sont des covariables, <code>Z</code> est l’assignation de traitement. <span class="math inline">\(N\)</span>=20.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Voici les 6 premières observations seulement :</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat2[, <span class="sc">-</span><span class="dv">7</span>])</span></code></pre></div>
<pre><code>  ID x1      x2 Y_Z_0 Y_Z_1 Z
1 01  1 -0.1162     0     1 0
2 02  1  1.8173     0     1 1
3 03  1  0.3706     0     1 0
4 04  1  0.5202     1     1 0
5 05  0 -0.7505     1     0 1
6 06  0  0.8169     0     1 0</code></pre>
</section>
<section id="résultats-binaires-paramètres-ii" class="slide level2">
<h2>Résultats binaires : paramètres II</h2>
<p>Comment interpréterions-nous les vraies quantités ou paramètres suivants ? <code>Y_Z_1</code>, <code>Y_Z_0</code> sont des résultats potentiels, <code>Y</code> est l’observation, <code>x1</code>, <code>x2</code> sont des covariables, <code>Z</code> est l’assignation de traitement. <span class="math inline">\(N\)</span>=20.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>ate_bin <span class="ot">&lt;-</span> <span class="fu">with</span>(dat2, <span class="fu">mean</span>(Y_Z_1 <span class="sc">-</span> Y_Z_0))</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>bary1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dat2<span class="sc">$</span>Y_Z_1)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>bary0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dat2<span class="sc">$</span>Y_Z_0)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>diff_log_odds_bin <span class="ot">&lt;-</span> <span class="fu">with</span>(</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  dat2,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(bary1 <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> bary1)) <span class="sc">-</span> <span class="fu">log</span>(bary0 <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> bary0))</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">bary1 =</span> bary1, <span class="at">bary0 =</span> bary0, <span class="at">true_ate =</span> ate_bin,</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">true_diff_log_odds =</span> diff_log_odds_bin</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>             bary1              bary0           true_ate true_diff_log_odds 
              0.55               0.55               0.00               0.00 </code></pre>
</section>
<section id="résultats-binaires-paramètres-iii" class="slide level2">
<h2>Résultats binaires : paramètres III</h2>
<p>Voulez-vous estimer la différence log-odds ?</p>
<p><span class="math display">\[\begin{equation}
\delta = \log \frac{\bar{y}_{1}}{1-\bar{y}_{1}} - \log \frac{ \bar{y}_0}{1- \bar{y}_0}
\end{equation}\]</span></p>
<p>Ou la différence en proportions ?</p>
<p><span class="math display">\[\begin{equation}
\bar{\tau} = \bar{y}_{1} - \bar{y}_0
\end{equation}\]</span></p>
<p>Rappelons que <span class="math inline">\(\bar{y}_1\)</span> est la <em>proportion</em> de <span class="math inline">\(y_{1}=1\)</span> dans les données.</p>
<p><span class="citation" data-cites="freedman2008randomization"><a href="#/ref-freedman2008randomization" role="doc-biblioref">Freedman</a> (<a href="#/ref-freedman2008randomization" role="doc-biblioref">2008b</a>)</span> montre que l’estimateur du coefficient logit est un estimateur biaisé de la différence du paramètre log-odds. Il montre également un estimateur sans biais de ce paramètre.</p>
<p>Nous savons que la différence en proportions dans l’échantillon devrait être un estimateur sans biais de la différence en proportions.</p>
</section>
<section id="un-exemple-destimation-i" class="slide level2">
<h2>Un exemple d’estimation I</h2>
<p>Comment interpréter les estimations suivantes ? Que requiert l’estimateur de la différence des moyennes en termes d’hypothèses ? Que requiert l’estimateur de régression logistique en termes d’hypothèses ?</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>lmbin1 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(Y <span class="sc">~</span> Z, <span class="at">data =</span> dat2)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>glmbin1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> Z, <span class="at">data =</span> dat2, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmbin1)[<span class="dv">2</span>, ]</span></code></pre></div>
<pre><code>  term estimate std.error statistic p.value conf.low conf.high df outcome
2    Z  -0.4048    0.2159    -1.875 0.07716  -0.8584   0.04884 18       Y</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(glmbin1)[<span class="dv">2</span>, ]</span></code></pre></div>
<pre><code># A tibble: 1 x 5
  term  estimate std.error statistic p.value
  &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 Z        -1.90      1.22     -1.55   0.120</code></pre>
</section>
<section id="un-exemple-destimation-ii" class="slide level2">
<h2>Un exemple d’estimation II</h2>
<p>Quid des covariables ? Pourquoi utiliser des covariables ?</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>lmbin2 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(Y <span class="sc">~</span> Z <span class="sc">+</span> x1, <span class="at">data =</span> dat2)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>glmbin2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> Z <span class="sc">+</span> x1, <span class="at">data =</span> dat2, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmbin2)[<span class="dv">2</span>, ]</span></code></pre></div>
<pre><code>  term estimate std.error statistic p.value conf.low conf.high df outcome
2    Z  -0.4058    0.2179    -1.862 0.07996  -0.8656   0.05398 17       Y</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(glmbin2)[<span class="dv">2</span>, ]</span></code></pre></div>
<pre><code># A tibble: 1 x 5
  term  estimate std.error statistic p.value
  &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 Z        -1.90      1.22     -1.55   0.120</code></pre>
</section>
<section id="un-exemple-destimation-iii" class="slide level2">
<h2>Un exemple d’estimation III</h2>
<p>Comparons nos estimations</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">dim =</span> <span class="fu">coef</span>(lmbin1)[[<span class="st">&quot;Z&quot;</span>]],</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dim_x1 =</span> <span class="fu">coef</span>(lmbin2)[[<span class="st">&quot;Z&quot;</span>]],</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">glm =</span> <span class="fu">coef</span>(glmbin1)[[<span class="st">&quot;Z&quot;</span>]],</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">glm_x1 =</span> <span class="fu">coef</span>(glmbin2)[[<span class="st">&quot;Z&quot;</span>]]</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>    dim  dim_x1     glm  glm_x1 
-0.4048 -0.4058 -1.8971 -1.9025 </code></pre>
</section>
<section id="un-exemple-destimation-les-estimateurs-de-plugin-freedman-i" class="slide level2">
<h2>Un exemple d’estimation : les estimateurs de plugin Freedman I</h2>
<p>Sans covariable : </p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>freedman_plugin_estfn1 <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  glmbin <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> Z, <span class="at">data =</span> dat2, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  preddat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Z =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">nrow</span>(dat2)))</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  preddat<span class="sc">$</span>yhat <span class="ot">&lt;-</span> <span class="fu">predict</span>(glmbin, <span class="at">newdata =</span> preddat, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  bary1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(preddat<span class="sc">$</span>yhat[preddat<span class="sc">$</span>Z <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  bary0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(preddat<span class="sc">$</span>yhat[preddat<span class="sc">$</span>Z <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  diff_log_odds <span class="ot">&lt;-</span> <span class="fu">log</span>(bary1 <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> bary1)) <span class="sc">-</span> <span class="fu">log</span>(bary0 <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> bary0))</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">estimate =</span> diff_log_odds))</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</section>
<section id="un-exemple-destimation-les-estimateurs-de-plugin-freedman-ii" class="slide level2">
<h2>Un exemple d’estimation : les estimateurs de plugin Freedman II</h2>
<p>Avec covariable : </p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>freedman_plugin_estfn2 <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  glmbin <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> Z <span class="sc">+</span> x1, <span class="at">data =</span> data, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  preddat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Z =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> N))</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  preddat<span class="sc">$</span>x1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(data<span class="sc">$</span>x1, <span class="dv">2</span>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  preddat<span class="sc">$</span>yhat <span class="ot">&lt;-</span> <span class="fu">predict</span>(glmbin, <span class="at">newdata =</span> preddat, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  bary1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(preddat<span class="sc">$</span>yhat[preddat<span class="sc">$</span>Z <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  bary0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(preddat<span class="sc">$</span>yhat[preddat<span class="sc">$</span>Z <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  diff_log_odds <span class="ot">&lt;-</span> <span class="fu">log</span>(bary1 <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> bary1)) <span class="sc">-</span> <span class="fu">log</span>(bary0 <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> bary0))</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">estimate =</span> diff_log_odds))</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Comparons nos estimations à partir des six estimateurs différents </p>
<pre><code>       dim     dim_x1        glm     glm_x1   freedman freeman_x1 
   -0.4048    -0.4058    -1.8971    -1.9025    -1.8971    -1.9020 </code></pre>
</section>
<section id="un-exemple-avec-declaredesign-pour-évaluer-nos-estimateurs-i" class="slide level2">
<h2>Un exemple avec DeclareDesign pour évaluer nos estimateurs I</h2>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># déclarer 4 estimateurs pour DeclareDesign</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># premier estimateur : régression linéaire avec l&#39;ATE comme cible</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>estb1 <span class="ot">&lt;-</span> <span class="fu">declare_estimator</span>(Y <span class="sc">~</span> Z,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> lm_robust, <span class="at">label =</span> <span class="st">&quot;lm1:Z&quot;</span>,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">inquiry =</span> thetarget_ate</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="co"># deuxième estimateur : régression linéaire avec covariable,</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="co"># avec l&#39;ATE comme cible</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>estb2 <span class="ot">&lt;-</span> <span class="fu">declare_estimator</span>(Y <span class="sc">~</span> Z <span class="sc">+</span> x1,</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> lm_robust, <span class="at">label =</span> <span class="st">&quot;lm1:Z,x1&quot;</span>,</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">inquiry =</span> thetarget_ate</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="co"># troisième estimateur : régression logistique, avec log odds comme cible</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>estb3 <span class="ot">&lt;-</span> <span class="fu">declare_estimator</span>(Y <span class="sc">~</span> Z,</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> glm, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>),</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">&quot;glm1:Z&quot;</span>, <span class="at">inquiry =</span> thetarget_logodds</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a><span class="co"># quatrième estimateur : régression logistique avec covariable,</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a><span class="co"># avec log odds comme cible</span></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>estb4 <span class="ot">&lt;-</span> <span class="fu">declare_estimator</span>(Y <span class="sc">~</span> Z <span class="sc">+</span> x1,</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> glm, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>),</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">&quot;glm1:Z,x1&quot;</span>, <span class="at">inquiry =</span> thetarget_logodds</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</section>
<section id="un-exemple-avec-declaredesign-pour-évaluer-nos-estimateurs-ii" class="slide level2">
<h2>Un exemple avec DeclareDesign pour évaluer nos estimateurs II</h2>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># des_bin combine population, résultats potentiels,</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co"># assignation et valeurs de résultat liées à Z</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co"># On ajoute les deux cibles et les quatre estimateurs.</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>des_bin_plus_est <span class="ot">&lt;-</span> des_bin <span class="sc">+</span> thetarget_ate <span class="sc">+</span> thetarget_logodds <span class="sc">+</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  estb1 <span class="sc">+</span> estb2 <span class="sc">+</span> estb3 <span class="sc">+</span> estb4</span></code></pre></div>
</section>
<section id="simuler-pour-évaluer-nos-estimateurs" class="slide level2">
<h2>Simuler pour évaluer nos estimateurs</h2>
<p>Comment interpréter cette figure ? (Les différences d’échelle rendent la tâche difficile.)</p>
<p><img src="figs/figsim_plot_bin-1.png" width=".95\textwidth"  /></p>
</section>
<section id="quel-estimateur-est-le-plus-proche-de-la-vérité-2" class="slide level2">
<h2>Quel estimateur est le plus proche de la vérité ?</h2>
<p>Quel estimateur fonctionne le mieux pour cette conception et ces données ?</p>
<table>
<caption>Performances de l’estimateur et des tests pour 5000 simulations des différents estimateurs et intervalles de confiance pour un résultat binaire et une conception totalement randomisée.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">est</th>
<th style="text-align: left;">estimand</th>
<th style="text-align: right;">bias</th>
<th style="text-align: right;">rmse</th>
<th style="text-align: right;">power</th>
<th style="text-align: right;">coverage</th>
<th style="text-align: right;">sd_est</th>
<th style="text-align: right;">mean_se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">glm1:Z</td>
<td style="text-align: left;">logodds</td>
<td style="text-align: right;">0.691</td>
<td style="text-align: right;">4.099</td>
<td style="text-align: right;">0.023</td>
<td style="text-align: right;">0.995</td>
<td style="text-align: right;">4.226</td>
<td style="text-align: right;">154.088</td>
</tr>
<tr class="even">
<td style="text-align: left;">glm1:Z,x1</td>
<td style="text-align: left;">logodds</td>
<td style="text-align: right;">0.850</td>
<td style="text-align: right;">4.815</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">0.993</td>
<td style="text-align: right;">4.934</td>
<td style="text-align: right;">249.506</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lm1:Z</td>
<td style="text-align: left;">ate</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.182</td>
<td style="text-align: right;">0.084</td>
<td style="text-align: right;">0.970</td>
<td style="text-align: right;">0.239</td>
<td style="text-align: right;">0.239</td>
</tr>
<tr class="even">
<td style="text-align: left;">lm1:Z,x1</td>
<td style="text-align: left;">ate</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">0.189</td>
<td style="text-align: right;">0.082</td>
<td style="text-align: right;">0.970</td>
<td style="text-align: right;">0.245</td>
<td style="text-align: right;">0.247</td>
</tr>
</tbody>
</table>
</section></section>
<section>
<section id="autres-sujets-liés-à-lestimation" class="title-slide slide level1">
<h1>Autres sujets liés à l’estimation</h1>

</section>
<section id="lajustement-de-covariable-paramètres" class="slide level2">
<h2>L’ajustement de covariable : paramètres</h2>
<p>En général, le simple fait de “contrôler pour” produit un estimateur biaisé du paramètre ATE <strong>ou</strong> ITT. Voir par exemple <span class="citation" data-cites="lin_agnostic_2013"><a href="#/ref-lin_agnostic_2013" role="doc-biblioref">Lin</a> (<a href="#/ref-lin_agnostic_2013" role="doc-biblioref">2013</a>)</span> et <span class="citation" data-cites="freedman2008rae"><a href="#/ref-freedman2008rae" role="doc-biblioref">Freedman</a> (<a href="#/ref-freedman2008rae" role="doc-biblioref">2008a</a>)</span>. <span class="citation" data-cites="lin_agnostic_2013"><a href="#/ref-lin_agnostic_2013" role="doc-biblioref">Lin</a> (<a href="#/ref-lin_agnostic_2013" role="doc-biblioref">2013</a>)</span> montre comment réduire ce biais et, surtout, que ce biais a tendance à être faible à mesure que la taille de l’échantillon augmente.</p>
</section></section>
<section>
<section id="conclusion" class="title-slide slide level1">
<h1>Conclusion</h1>

</section>
<section id="réflexions-finales-sur-lestimation" class="slide level2">
<h2>Réflexions finales sur l’estimation</h2>
<ul>
<li><p>Les paramètres causaux contrefactuels sont des fonctions non observées des résultats potentiels.</p></li>
<li><p>Les estimateurs sont des recettes ou des formules de calcul qui utilisent des données observées pour en savoir plus sur un paramètre.</p></li>
<li><p>Les bons estimateurs produisent des estimations proches du vrai paramètre.</p></li>
<li><p>(Liant l’estimation aux tests) l’erreur type des estimateurs nous permet de calculer les intervalles de confiance et les <span class="math inline">\(p\)</span>-valeurs. Certains estimateurs ont une erreur type plus grande ou plus petite (ou plus ou moins correcte).</p></li>
<li><p>Vous pouvez évaluer l’utilité d’un estimateur choisi pour un paramètre choisi par simulation.</p></li>
</ul>
</section></section>
<section>
<section id="effets-causaux-qui-diffèrent-selon-les-groupes-ou-covariables" class="title-slide slide level1">
<h1>Effets causaux qui diffèrent selon les groupes ou covariables</h1>

</section>
<section id="effets-différents-selon-les-groupes-i" class="slide level2">
<h2>Effets différents selon les groupes I</h2>
<p>Si notre théorie suggère que les effets devraient différer selon le groupe, comment pouvons-nous évaluer les preuves pour ou contre une telle affirmation ?</p>
<ul>
<li><p>Nous pouvons <strong>concevoir</strong> une évaluation de cette théorie en créant une étude aléatoire par bloc — avec des blocs définis par des groupes théoriquement pertinents.</p></li>
<li><p>Nous pouvons <strong>planifier</strong> une telle évaluation en (1) <strong>pré-enregistrant des analyses de sous-groupes spécifiques</strong> (que nous retenons ou non ce groupe dans la phase de conception) et en (2) veillant à mesurer l’appartenance au groupe pendant la collecte des données de base pré-traitement</p></li>
</ul>
</section>
<section id="effets-différents-selon-les-groupes-ii" class="slide level2">
<h2>Effets différents selon les groupes II</h2>
<ul>
<li><p>Si on ne l’a pas prévu en avance, les analyses par sous-groupes peuvent être utiles pour explorer mais pas pour confirmer: elles peuvent trop facilement apporter trop d’hypothèses de test et donc gonfler le taux de faux positifs.</p></li>
<li><p>Nous <strong>ne devrions pas utiliser des groupes formés par traitement</strong>. (Il s’agit soit d’une “analyse de médiation” soit d’un “conditionnement sur les variables post-traitement” et mérite son propre module).</p></li>
</ul>
</section></section>
<section>
<section id="effets-causaux-quand-on-ne-contrôle-pas-la-dose" class="title-slide slide level1">
<h1>Effets causaux quand on ne contrôle pas la dose</h1>

</section>
<section id="définir-leffet-causal-i" class="slide level2">
<h2>Définir l’effet causal I</h2>
<p>Imaginez une expérience de porte-à-porte où certaines maisons sont assignées de manière aléatoire pour recevoir une visite. Notez que nous utilisons maintenant <span class="math inline">\(Z\)</span> et <span class="math inline">\(d\)</span> au lieu de <span class="math inline">\(T\)</span>.</p>
<ul>
<li><span class="math inline">\(Z_i\)</span> est l’assignation aléatoire à une visite (<span class="math inline">\(Z_i=1\)</span>) ou non (<span class="math inline">\(Z_i=0\)</span>).</li>
<li><span class="math inline">\(d_{i,Z_i=1}=1\)</span> signifie que la personne <span class="math inline">\(i\)</span> ouvrirait la porte pour avoir une conversation lors d’une visite.</li>
<li><span class="math inline">\(d_{i,Z_i=1}=0\)</span> signifie que la personne <span class="math inline">\(i\)</span> n’ouvrirait pas la porte pour avoir une conversation lors d’une visite.</li>
<li>L’ouverture de la porte est un résultat du traitement.</li>
</ul>
</section>
<section id="définir-leffet-causal-ii" class="slide level2">
<h2>Définir l’effet causal II</h2>
<ul>
<li><p><span class="math inline">\(y_{i,Z_i = 1, d_{i,Z_i=1}=1}\)</span> est le résultat potentiel pour les personnes qui ont reçu une visite et qui ont ouvert la porte. (“Conformistes” ou “Toujours preneurs”)</p></li>
<li><p><span class="math inline">\(y_{i,1, d_{i,Z_i=1}=0}\)</span> est le résultat potentiel pour les personnes qui ont reçu une visite et qui n’ont pas ouvert la porte. (“Jamais preneurs” ou “Non-conformistes”)</p></li>
<li><p><span class="math inline">\(y_{i,0, d_{i,0}=1}\)</span> est le résultat potentiel pour les personnes qui n’ont pas reçu de visite et qui ont ouvert la porte. (“Non-conformistes” ou “Toujours preneurs”)</p></li>
<li><p><span class="math inline">\(y_{i,0, d_{i,0}=0}\)</span> est le résultat potentiel pour les personnes qui n’ont pas reçu de visite et qui n’auraient pas ouvert la porte. (“Conformistes” ou “Jamais preneurs”)</p></li>
</ul>
</section>
<section id="définir-leffet-causal-iii" class="slide level2">
<h2>Définir l’effet causal III</h2>
<p>On pourrait aussi écrire <span class="math inline">\(y_{i,Z_i = 0, d_{i,Z_i=1}=1}\)</span> pour les personnes qui n’avaient pas reçu de visite mais qui auraient ouvert la porte si une visite leur avait été assignée, etc.</p>
<p>Dans ce cas, nous pouvons simplifier nos résultats potentiels:</p>
<ul>
<li><span class="math inline">\(y_{i,0, d_{i,1}=1} = y_{i,0, d_{i,1}=0} = y_{i,0, d_{i,0}=0}\)</span> parce que votre résultat est le même quelle que soit la façon dont vous n’ouvrez pas la porte.</li>
</ul>
</section>
<section id="définir-leffet-causal-iv" class="slide level2">
<h2>Définir l’effet causal IV</h2>
<p>Nous pouvons simplifier les façons dont les gens reçoivent une dose du traitement comme ceci: (où <span class="math inline">\(d\)</span> est en minuscule reflétant l’idée que le fait d’ouvrir ou non la porte est un attribut fixe comme un résultat potentiel).</p>
<ul>
<li><span class="math inline">\(Y\)</span> : le résultat (<span class="math inline">\(y_{i,Z}\)</span> ou <span class="math inline">\(y_{i,Z_i=1}\)</span> pour le résultat potentiel du traitement pour la personne <span class="math inline">\(i\)</span>, fixe)</li>
<li><span class="math inline">\(X\)</span> : covariable/variable de base</li>
<li><span class="math inline">\(Z\)</span> : assignation de traitement (<span class="math inline">\(Z_i=1\)</span> si assigné à une visite, <span class="math inline">\(Z_i=0\)</span> si non assigné à une visite)</li>
<li><span class="math inline">\(D\)</span> : traitement reçu (<span class="math inline">\(D_i=1\)</span> si a répondu, <span class="math inline">\(D_i=0\)</span> si la personne <span class="math inline">\(i\)</span> n’a pas répondu) (en utilisant <span class="math inline">\(D\)</span> ici car <span class="math inline">\(D_i = d_{i,1} Z_ {i} + d_{i,0} (1-Z_i)\)</span>)</li>
</ul>
</section>
<section id="définir-leffet-causal-v" class="slide level2">
<h2>Définir l’effet causal V</h2>
<p>Nous avons deux effets causaux de <span class="math inline">\(Z\)</span> : <span class="math inline">\(Z \rightarrow Y\)</span> (<span class="math inline">\(\delta\)</span>, ITT, ITT<span class="math inline">\(_Y\)</span>) et <span class="math inline">\(Z \rightarrow D\)</span> (Gerber et Green appelle cela ITT<span class="math inline">\(_D\)</span>).</p>
<p>Et différents types de personnes peuvent réagir différemment à la tentative de déplacer la dose avec l’instrument.</p>
</section>
<section id="définir-leffet-causal-vi" class="slide level2">
<h2>Définir l’effet causal VI</h2>
<p><span class="math inline">\(ITT=ITT_Y=\delta= \bar{y}_{Z=1} - \bar{y}_{Z=0}\)</span></p>
<p>Mais, dans cette conception, <span class="math inline">\(\bar{y}_{Z=1}=\bar{y}_{1}\)</span> est divisé en plusieurs parties : le résultat de ceux qui ont répondu à la porte (conformistes et toujours-preneurs et non-conformistes). Écrivez <span class="math inline">\(p_C\)</span> pour la proportion de conformistes dans cette étude.</p>
<p><span class="math display">\[\begin{equation}
\bar{y}_{1}=(\bar{y}_{1}|C)p_C + (\bar{y}_{1}|A)p_A + (\bar{y}_1|N)p_N + (\bar{y}_1|D)p_D.
\end{equation}\]</span></p>
<p>Et <span class="math inline">\(\bar{y}_{0}\)</span> est divisé en plusieurs parties:</p>
<p><span class="math display">\[\begin{equation}
\bar{y}_{0}=(\bar{y}_{0}|C)p_C + (\bar{y}_{1}|A)p_A + (\bar{y}_{0}|N)p_N + (\bar{y}_0|D)p_D.
\end{equation}\]</span></p>
</section>
<section id="définir-leffet-causal-vii" class="slide level2">
<h2>Définir l’effet causal VII</h2>
<p>Ainsi, l’ITT lui-même est une combinaison des effets de <span class="math inline">\(Z\)</span> sur <span class="math inline">\(Y\)</span> au sein de ces différents groupes (imaginez une substitution puis réorganisation de sorte que nous ayons un ensemble d’ITT, un pour chaque type de sujet). Mais, nous pouvons toujours l’estimer car nous avons des estimateurs sans biais de <span class="math inline">\(\bar{y}_1\)</span> et <span class="math inline">\(\bar{y}_0\)</span> au sein de chaque type.</p>
</section>
<section id="comprendre-litt-i" class="slide level2">
<h2>Comprendre l’ITT I</h2>
<p>Tout d’abord, découvrons l’effet de la politique elle-même. Pour écrire l’ITT, nous n’avons pas besoin de considérer tous les types ci-dessus. Nous n’avons pas de non-conformistes (<span class="math inline">\(p_D=0\)</span>) et nous savons que l’ITT pour les toujours-preneurs et les jamais-preneurs est de 0.</p>
<p><span class="math display">\[\begin{equation}
\bar{y}_{1}=(\bar{y}_{1}|C)p_C + (\bar{y}_{1}|A)p_A + (\bar{y}_1|N)p_N
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
\bar{y}_{0}=(\bar{y}_{0}|C)p_C + (\bar{y}_{0}|A)p_A + (\bar{y}_{0}|N)p_N
\end{equation}\]</span></p>
</section>
<section id="comprendre-litt-ii" class="slide level2">
<h2>Comprendre l’ITT II</h2>
<p>Tout d’abord, découvrons l’effet de la politique elle-même. Pour écrire l’ITT, nous n’avons pas besoin de considérer tous les types ci-dessus. Nous n’avons pas de non-conformistes (<span class="math inline">\(p_D=0\)</span>) et nous savons que l’ITT pour les toujours-preneurs et les jamais-preneurs est de 0.</p>
<p><span class="math display">\[\begin{align}
ITT    = &amp; \bar{y}_{1} - \bar{y}_{0} \\
        = &amp; ( (\bar{y}_{1}|C)p_C + (\bar{y}_{1}|A)p_A + (\bar{y}_1|N)p_N ) - \\
       &amp; ( (\bar{y}_{0}|C)p_C + (\bar{y}_{0}|A)p_A + (\bar{y}_{0}|N)p_N )  \\
       \intertext{en collectant ensemble chaque type --- pour avoir un ITT pour chaque type}
       = &amp; ( (\bar{y}_{1}|C)p_C -  (\bar{y}_{0}|C)p_C )  +   ( (\bar{y}_{1}|A)p_A - (\bar{y}_{1}|A)p_A ) + \\
       &amp; ( (\bar{y}_1|N)p_N  - (\bar{y}_{0}|N)p_N ) \\
       = &amp; \left( (\bar{y}_{1}|C) -  (\bar{y}_{0}|C) \right)p_C   +  \\
       &amp; \left( (\bar{y}_{1}|A)- (\bar{y}_{0}|A) \right)p_A  +  \left( (\bar{y}_1|N) - (\bar{y}_{0}|N) \right)p_N
\end{align}\]</span></p>
</section>
<section id="comprendre-litt" class="slide level2">
<h2>Comprendre l’ITT</h2>
<p><span class="math display">\[\begin{align}
ITT     = &amp;   \bar{y}_{1} - \bar{y}_{0} \\
        = &amp;  ( (\bar{y}_{1}|C)p_C + (\bar{y}_{1}|A)p_A + (\bar{y}_1|N)p_N ) - \\
       &amp; ( (\bar{y}_{0}|C)p_C + (\bar{y}_{0}|A)p_A + (\bar{y}_{0}|N)p_N )  \\
        = &amp;   ( (\bar{y}_{1}|C)p_C -  (\bar{y}_{0}|C)p_C )  +   ( (\bar{y}_{1}|A)p_A - (\bar{y}_{1}|A)p_A ) + \\
       &amp; ( (\bar{y}_1|N)p_N  - (\bar{y}_{0}|N)p_N ) \\
        = &amp;   ( (\bar{y}_{1}|C) -  (\bar{y}_{0}|C))p_C   +   ( (\bar{y}_{1}|A)- (\bar{y}_{0}|A))p_A  + \\
       &amp; ( (\bar{y}_1|N) - (\bar{y}_{0}|N) )p_N
\end{align}\]</span></p>
</section>
<section id="comprendre-litt-iv" class="slide level2">
<h2>Comprendre l’ITT IV</h2>
<p>Et, si l’effet de la dose ne peut se produire que pour ceux qui ouvrent la porte, et que vous ne pouvez ouvrir la porte que lorsque vous êtes assigné au traitement, alors:</p>
<p><span class="math display">\[\begin{equation}
( (\bar{y}_{1}|A)- (\bar{y}_{0}|A))p_A = 0  \text{ and } ( (\bar{y}_1|N) - (\bar{y}_{0}|N) )p_N = 0
\end{equation}\]</span></p>
<p>Et</p>
<p><span class="math display">\[\begin{equation}
ITT =  ( (\bar{y}_{1}|C) -  (\bar{y}_{0}|C))p_C  = ( CACE ) p_C.
\end{equation}\]</span></p>
</section>
<section id="leffet-causal-moyen-pour-ceux-qui-se-conforment-au-traitement-i" class="slide level2">
<h2>L’effet causal moyen pour ceux qui se conforment au traitement I</h2>
<p>Nous aimerions également en savoir plus sur l’effet causal d’ouvrir la porte et d’avoir la conversation, un effet théoriquement intéressant.</p>
<p>Mais cette comparaison est mise à mal par <span class="math inline">\(x\)</span> : une simple comparaison <span class="math inline">\(\bar{Y}|D=1 - \bar{Y}|D=0\)</span> nous renseigne sur les différences de résultat dues à <span class="math inline">\(x\)</span> en plus de la différence causée par <span class="math inline">\(D\)</span>. (Voir les chiffres ci-dessous à partir de certaines données simulées)</p>
</section>
<section id="leffet-causal-moyen-pour-ceux-qui-se-conforment-au-traitement-ii" class="slide level2">
<h2>L’effet causal moyen pour ceux qui se conforment au traitement II</h2>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(dat, <span class="fu">cor</span>(Y, x)) <span class="do">## peut être quelconque</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(dat, <span class="fu">cor</span>(d, x)) <span class="do">## peut être quelconque</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(dat, <span class="fu">cor</span>(Z, x)) <span class="do">## devrait être proche de 0</span></span></code></pre></div>
<p>Mais nous venons de voir que, dans cette conception et avec ces hypothèses (y compris l’hypothèse SUTVA) que <span class="math inline">\(ITT = ( (\bar{y}_{1}|C) - (\bar{y}_{0}|C))p_C = (CACE) p_C\)</span>, on peut donc définir <span class="math inline">\(CACE=ITT/p_C\)</span>.</p>
</section>
<section id="comment-calculer-litt-et-le-cacelate-i" class="slide level2">
<h2>Comment calculer l’ITT et le CACE/LATE I</h2>
<p>Un exemple de données (où nous connaissons tous les résultats potentiels):</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">X</th>
<th style="text-align: right;">u</th>
<th style="text-align: left;">type</th>
<th style="text-align: right;">Z</th>
<th style="text-align: right;">pZ</th>
<th style="text-align: right;">DZ1</th>
<th style="text-align: right;">YD0Z0</th>
<th style="text-align: right;">YD1Z0</th>
<th style="text-align: right;">YD0Z1</th>
<th style="text-align: right;">YD1Z1</th>
<th style="text-align: right;">D</th>
<th style="text-align: right;">Y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1.95</td>
<td style="text-align: left;">Conformiste</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.95</td>
<td style="text-align: right;">2.52</td>
<td style="text-align: right;">1.95</td>
<td style="text-align: right;">2.52</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.95</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: left;">Conformiste</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.63</td>
</tr>
</tbody>
</table>
</section>
<section id="comment-calculer-litt-et-le-cacelate-ii" class="slide level2">
<h2>Comment calculer l’ITT et le CACE/LATE II</h2>
<p>L’ITT et le CACE</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>itt_y <span class="ot">&lt;-</span> <span class="fu">difference_in_means</span>(Y <span class="sc">~</span> Z, <span class="at">data =</span> dat0)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>itt_y</span></code></pre></div>
<pre><code>Design:  Standard 
  Estimate Std. Error t value Pr(&gt;|t|) CI Lower CI Upper    DF
Z  0.08725      0.233  0.3745   0.7089  -0.3752   0.5497 97.97</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>itt_d <span class="ot">&lt;-</span> <span class="fu">difference_in_means</span>(D <span class="sc">~</span> Z, <span class="at">data =</span> dat0)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>itt_d</span></code></pre></div>
<pre><code>Design:  Standard 
  Estimate Std. Error t value  Pr(&gt;|t|) CI Lower CI Upper    DF
Z     0.68    0.07307   9.307 8.454e-15   0.5348   0.8252 89.31</code></pre>
</section>
<section id="comment-calculer-litt-et-le-cacelate-iii" class="slide level2">
<h2>Comment calculer l’ITT et le CACE/LATE III</h2>
<p>Tous ensemble<a href="#/fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>cace_est <span class="ot">&lt;-</span> <span class="fu">iv_robust</span>(Y <span class="sc">~</span> D <span class="sc">|</span> Z, <span class="at">data =</span> dat0)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>cace_est</span></code></pre></div>
<pre><code>            Estimate Std. Error t value Pr(&gt;|t|) CI Lower CI Upper DF
(Intercept)   0.3347     0.1912  1.7502  0.08321 -0.04479   0.7142 98
D             0.1283     0.3404  0.3769  0.70705 -0.54727   0.8039 98</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Remarquez que c&#39;est identique ci-dessous:</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(itt_y)[[<span class="st">&quot;Z&quot;</span>]] <span class="sc">/</span> <span class="fu">coef</span>(itt_d)[[<span class="st">&quot;Z&quot;</span>]]</span></code></pre></div>
<pre><code>[1] 0.1283</code></pre>
</section>
<section id="résumé-des-conceptions-incitatives-conformistes-par-dose" class="slide level2">
<h2>Résumé des conceptions incitatives / conformistes / par dose:</h2>
<ul>
<li>Analysez au fur et à mesure de la randomisation, même lorsque vous ne contrôlez pas la dose</li>
<li>Le danger de l’analyse par protocole.</li>
</ul>
</section>
<section id="références" class="slide level2 unnumbered">
<h2 class="unnumbered">Références</h2>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-freedman2008rae" class="csl-entry" role="doc-biblioentry">
Freedman, David A. 2008a. <span>“<span class="nocase">On regression adjustments to experimental data</span>.”</span> <em>Advances in Applied Mathematics</em> 40 (2): 180–93.
</div>
<div id="ref-freedman2008randomization" class="csl-entry" role="doc-biblioentry">
———. 2008b. <span>“Randomization Does Not Justify Logistic Regression.”</span> <em>Statistical Science</em> 23 (2): 237–49.
</div>
<div id="ref-imbens2005robust" class="csl-entry" role="doc-biblioentry">
Imbens, Guido W., and Paul R. Rosenbaum. 2005. <span>“Robust, Accurate Confidence Intervals with a Weak Instrument: Quarter of Birth and Education.”</span> <em>Journal of the Royal Statistical Society Series A</em> 168 (1): 109–26.
</div>
<div id="ref-lin_agnostic_2013" class="csl-entry" role="doc-biblioentry">
Lin, Winston. 2013. <span>“Agnostic Notes on Regression Adjustments to Experimental Data: <span>Reexamining</span> <span>Freedman</span>’s Critique.”</span> <em>The Annals of Applied Statistics</em> 7 (1): 295–318.
</div>
</div>
</section></section>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>fonctionne quand <span class="math inline">\(Z \rightarrow D\)</span> n’est pas faible ; voir <span class="citation" data-cites="imbens2005robust"><a href="#/ref-imbens2005robust" role="doc-biblioref">Imbens and Rosenbaum</a> (<a href="#/ref-imbens2005robust" role="doc-biblioref">2005</a>)</span> pour les précautions d’usage<a href="#/fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
    </div>
  </div>

  <script src="estimation-slides_files/reveal.js-3.3.0.1/lib/js/head.min.js"></script>
  <script src="estimation-slides_files/reveal.js-3.3.0.1/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        // Display the page number of the current slide
        slideNumber: true,
        // Push each slide change to the browser history
        history: true,
        // Vertical centering of slides
        center: false,
        // Opens links in an iframe preview overlay
        previewLinks: true,
        // Transition style
        transition: 'fade', // none/fade/slide/convex/concave/zoom
        // Transition style for full page slide backgrounds
        backgroundTransition: 'default', // none/fade/slide/convex/concave/zoom



        chalkboard: {
          toggleNotesButton: false,
          theme: 'whiteboard',
        },

        keyboard: {
          67: function() { RevealChalkboard.toggleNotesCanvas() },    // toggle notes canvas when 'c' is pressed
          66: function() { RevealChalkboard.toggleChalkboard() }, // toggle chalkboard when 'b' is pressed
          46: function() { RevealChalkboard.clear() },    // clear chalkboard when 'DEL' is pressed
           8: function() { RevealChalkboard.reset() },    // reset chalkboard data on current slide when 'BACKSPACE' is pressed
          68: function() { RevealChalkboard.download() }, // downlad recorded chalkboard drawing when 'd' is pressed
        },

        // Optional reveal.js plugins
        dependencies: [
          { src: 'estimation-slides_files/reveal.js-3.3.0.1/plugin/notes/notes.js', async: true },
          { src: 'estimation-slides_files/reveal.js-3.3.0.1/plugin/search/search.js', async: true },
          { src: 'estimation-slides_files/reveal.js-3.3.0.1/plugin/chalkboard/chalkboard.js', async: true },
        ]
      });
    </script>
  <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
      document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>

<script>
  (function() {
    if (window.jQuery) {
      Reveal.addEventListener( 'slidechanged', function(event) {  
        window.jQuery(event.previousSlide).trigger('hidden');
        window.jQuery(event.currentSlide).trigger('shown');
      });
    }
  })();
</script>


  </body>
</html>
